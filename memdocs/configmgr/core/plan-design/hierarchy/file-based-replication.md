---
title: 檔案複寫
titleSuffix: Configuration Manager
description: 了解 Configuration Manager 如何使用檔案型複寫在階層中的站台間傳輸資料
ms.date: 08/09/2019
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 65fcc1a8-214e-4dd9-8093-de4cd4a00442
author: mestew
ms.author: mstewart
manager: dougeby
ms.openlocfilehash: b7d7f1564057a7a942fc4a32064eb54cdbfa890d
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/21/2020
ms.locfileid: "81703556"
---
# <a name="file-based-replication"></a>檔案複寫

適用於：  Configuration Manager (最新分支)

Configuration Manager 會使用檔案複寫在階層中網站間傳送檔案資料。 此資料包括您想要部署到子站台中發佈點的應用程式和封裝。 它也會處理未處理的探索資料記錄，站台會將這些資料記錄傳送至其父站台，然後加以處理。  

站台之間的檔案型通訊會透過 TCP/IP 連接埠 445 來使用伺服器訊息區  (SMB) 通訊協定。 若要控制站台透過網路傳輸的資料量，請指定頻寬節流設定和脈衝模式。 使用排程來控制透過網路傳送資料的時機。  

## <a name="routes"></a><a name="bkmk_routes"></a> 路由

下列資訊可協助您設定和使用檔案複寫路由。  

### <a name="file-replication-route"></a>檔案複寫路由

每個檔案複寫路由都會識別站台可傳送檔案資料的目的地站台。 每個站台都支援連接至特定目的地站台的一個檔案複寫路由。  

若要管理檔案複寫路由，請移至 [系統管理]  工作區。 展開 [階層設定]  節點，然後選取 [檔案複寫]  。  

您可以變更下列檔案複寫路由設定：  

#### <a name="file-replication-account"></a>檔案複寫帳戶

此帳戶會連線至目的地站台，以及將資料寫入該站台的 **SMS_Site** 共用。 接收站台會處理寫入至此共用的資料。 根據預設，將站台新增至階層時，Configuration Manager 會將新站台伺服器的電腦帳戶指派為其檔案複本帳戶。 然後，它會將此帳戶新增至目的地站台的 `SMS_SiteToSiteConnection_<sitecode>` 群組。 此群組位於電腦本機，可授與對 SMS_Site 共用的存取權。 您可以將此帳戶變更為 Windows 使用者帳戶。 如果您變更帳戶，請務必將新帳戶新增至目的地站台的 `SMS_SiteToSiteConnection_<sitecode>` 群組。  

> [!NOTE]  
> 次要網站一律使用次要網站伺服器的電腦帳戶做為 [檔案複寫帳戶]  。  

#### <a name="schedule"></a>排程

設定每個檔案複寫路由的排程。 此動作限制資料可以傳輸至目的地站台的資料類型和時間。  

#### <a name="rate-limits"></a>速率限制

指定每個檔案複寫路由的速率限制。 此動作控制站台在將資料傳輸到目的地站台時使用的網路頻寬：  

- **脈衝模式**：指定站台傳送至目的地站台的資料區塊大小。 您也可以指定傳送每個資料區塊之間的時間延遲。 當您必須經由低頻寬的網路連線將資料傳送至目的地站台時，請使用此選項。

    例如，您有每五秒傳送 1 KB 資料的限制，而非每三秒傳送 1 KB 的限制。 此限制與特定時間的連結速度或其使用狀況無關。

- **限制為每小時的最大傳送速率**：站台只會使用您指定的時間百分比，將資料傳送至目的地站台。 Configuration Manager 不會識別網路的可用頻寬。 它會將可傳送資料的時間細分成時間片段。 接著，它會在一小段時間內傳送資料，下一段時間則不傳送資料。

    例如，您將最大速率設為 **50%** 。 Configuration Manager 會在沒有傳送任何資料時的一段相等時間間隔之後，傳輸一定時間量的資料。 它不會管理所傳送之資料區塊的實際大小。 站台只會管理傳送資料的時間長度。  

    > [!CAUTION]  
    > 根據預設，網站最多可以使用三個 [並行傳送]  將資料傳送至目的地網站。 當您啟用檔案複寫路由的速率限制時，它會將**並行傳送**至該站台限制為一個。 此行為即使在 [限制可用的頻寬 (%)]  設為 [100%]  時也適用。 例如，如果您針對寄件者使用預設設定，這樣就會將傳送至目的地站台的傳輸速率減少為預設容量的三分之一。  

#### <a name="routes-between-secondary-sites"></a>次要站台之間的路由

在兩個次要站台之間設定檔案型複寫路由，在站台之間路由傳送檔案型內容。  


### <a name="sender"></a>傳送者

每個網站都有一位傳送者。 傳送者會管理從一個站台到目的地站台的網路連線。 它可以同時建立對多個站台的連線。 為了連線至站台，傳送者會使用至該網站的檔案複寫路由，並識別用來建立網路連線的帳戶。 傳送者也會使用這個帳戶將資料寫入目的地站台的 SMS_Site 共用。  

根據預設，傳送者會使用多個**並行傳送** (或執行緒  ) 將資料寫入目的地站台。 每個執行緒都可以將不同的檔案型物件傳輸到目的地站台。 當傳送者開始傳送物件時，傳送者會繼續寫入該物件的資料區塊，直到整個物件傳送完畢為止。 當它將物件的所有資料都傳送完畢後，新的物件就可以開始在該執行緒上傳送。  

若要管理站台的傳送者，請移至 [系統管理]  工作區，然後展開 [站台設定]  節點。 選取 [站台]  節點，然後選取您想要管理之站台的 [內容]  。 切換到 [傳送者]  索引標籤，以變更傳送者設定。  

您可以為傳送者變更以下設定：  

#### <a name="maximum-concurrent-sendings"></a>並行傳送上限

根據預設，每個站台都會使用五個並行傳送 (執行緒)。 有三個執行緒可在將資料傳送到任何一個目的地站台時使用。 增加此數目時，您可以增加站台間資料的輸送量。 更多執行緒表示 Configuration Manager 可以同時傳輸更多檔案。 不過，增加數量也會增加對網站間網路頻寬的需求。  

#### <a name="retry-settings"></a>重試設定

根據預設，每個站台都會重試有問題的連線兩次，每次連線嘗試間會有一分鐘的延遲。 您可以修改站台進行連線嘗試的次數，以及嘗試之間等候的時間長度。  


## <a name="next-steps"></a>後續步驟

[Database replication](database-replication.md)
