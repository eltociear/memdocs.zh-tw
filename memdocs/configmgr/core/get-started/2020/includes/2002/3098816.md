---
author: mestew
ms.author: mstewart
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: include
ms.date: 02/13/2020
ms.openlocfilehash: 767174ccbb63287ecc595d6e0c47ebc604e8103a
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/21/2020
ms.locfileid: "81693086"
---
## <a name="improvements-to-orchestration-groups"></a><a name="bkmk_orch"></a> 協調流程群組的改善
<!--3098816-->
建立協調流程群組以使用更好的方式控制裝置的軟體更新部署。 協調流程可讓您依百分比、特定數字或明確順序來彈性地更新裝置。 您也可以在裝置執行更新部署之前或之後執行 PowerShell 指令碼。

協調流程群組是「伺服器群組」功能的演進。 其最早出現在 [Configuration Manager Technical Preview 1909 版](../../../2019/technical-preview-1909.md)中。 我們已在[技術預覽 2001](../../technical-preview-2001.md#bkmk_orch) 與[技術預覽 2001.2](../../technical-preview-2001-2.md#bkmk_orch) 中改善協調流程群組。 在此 Technical Preview 中，我們為協調流程群組新增了下列改善：

- 清除協調流程群組成員的狀態 (例如 [已完成]  或 [已失敗]  )，以便您可以重新執行協調流程。
   - 以滑鼠右鍵按一下協調流程群組成員，然後選取 [重設協調流程群組成員]  。
- 針對選取的成員開始進行如 [資源總管]  與 [啟用詳細資訊記錄]  的基本作業。
- 需要重新啟動的更新現在可以搭配協調流程運作。


[![重設協調流程群組成員](../../media/3098816-reset-og-member.png)](../../media/3098816-reset-og-member.png#lightbox)


### <a name="try-it-out"></a>試試看！

請嘗試完成工作。 接著，傳送[意見反應](../../../../understand/find-help.md#product-feedback)以及您對於此功能的想法。

#### <a name="prerequisites"></a>先決條件

- 若要查看所有協調流程群組與那些群組的任何更新，您的帳戶需要成為**系統高權限管理員**。
- 啟用**協調流程群組**功能。 如需詳細資訊，請參閱[啟用選擇性功能](../../../../servers/manage/install-in-console-updates.md#bkmk_options)。

    > [!NOTE]
    > 當您啟用**協調流程群組**時，站台會停用**伺服器群組**功能。 此行為可避免兩個功能之間發生任何衝突。

#### <a name="create-an-orchestration-group"></a>建立協調流程群組

1. 在 Configuration Manager 主控台中，移至 [資產與合規性]  工作區，然後選取 [協調流程群組]  節點。

1. 在功能區中，選取 [建立協調流程群組]  以開啟 [建立協調流程群組精靈]  。

1. 在 [一般]  頁面上，為您的協調流程群組提供 [名稱]  與選擇性的 [描述]  。 為下列項目指定您的值：
   - **協調流程群組逾時 (分鐘)** ：所有群組成員完成更新安裝的時間限制。
   - **協調流程群組成員逾時 (分鐘)** ：群組中單一裝置完成更新安裝的時間限制。


1. 在 [成員選取]  頁面上，先指定 [站台碼]  。 接著，選取 [新增]  以新增裝置資源作為此協調流程群組的成員。 依裝置**搜尋**裝置，然後**新增**它們。 您也可以使用 [在集合中搜尋]  將搜尋篩選至單一集合。  當您完成將裝置新增到選取的資源清單時，請選取 [確定]  。
   - 選取群組的資源時，只會顯示有效的用戶端。 已進行檢查來驗證站台代碼、已安裝用戶端，以及資源未重複。

1. 在 [規則選取]  頁面上，選取下列其中一個選項：

   - [允許同時更新一部分的電腦]  ，然後選取或輸入此百分比的數字。 使用此設定來允許未來彈性的協調流程群組大小。 例如，您的協調流程群組包含 50 部裝置，而且您將此值設定為 10。 在軟體更新部署期間，Configuration Manager 允許五部裝置同時執行部署。 若您稍後將協調流程群組大小新增為 100 部裝置，則一次可更新 10 部裝置。

   - [允許同時更新多部電腦]  ，然後選取或輸入此特定計數的數字。 使用此設定來一律限制特定裝置數目，不論協調流程群組整體大小為何。

   - [指定維護順序]  ，然後以特定順序將選取的資源排序。 使用此設定來明確定義裝置執行軟體更新部署的特定順序。

1. 在 [PreScript]  頁面上，輸入執行部署之前  要在每部裝置上執行的 PowerShell 指令碼。 該指令碼會傳回 `0` (代表成功) 或 `3010` (成功但需要重新啟動)。 指定 [指令碼逾時 (分鐘)]  值，若指令碼未在這個指定的時間內完成則會失敗。

1. 在 [PostScript]  頁面上，輸入執行部署「之後」  要在每部裝置上執行的 PowerShell 指令碼，以及 [指令碼逾時 (分鐘)]  值。 行為與 PreScript 相同。

1. 完成精靈。
1. 您可以使用群組的 [屬性]  來變更現有協調流程群組的設定。 
1. 若要刪除協調流程群組，請加以選取並選取功能區中的 [刪除]  。

#### <a name="view-orchestration-groups-and-members"></a>檢視協調流程群組與成員

從 [資產與合規性]  工作區中，選取 [協調流程群組]  節點。 若要檢視成員，請選取協調流程群組，然後選取功能區中的 [顯示成員]  。 如需節點可用資料行的詳細資訊，請參閱[監視協調流程群組與成員](#bkmk_orch_monitor)。


#### <a name="start-orchestration"></a>啟動協調流程

- [部署軟體更新](../../../../../sum/deploy-use/deploy-software-updates.md)至包含協調流程群組成員的集合。
   - 協調流程會在群組中的任何用戶端嘗試在期限之前或維護時段期間安裝任何軟體更新時開始。 它會針對整個群組開始，並確定裝置依下列協調流程群組規則更新。
- 您可以從 [協調流程群組]  節點選取協調流程，然後從功能區或右鍵功能表中選擇 [啟動協調流程]  來手動加以啟動。  

> [!TIP]
> - 協調流程群組只會套用到軟體更新部署。 它們不會套用到其他部署。
> - 您能以滑鼠右鍵按一下協調流程群組成員，然後選取 [重設協調流程群組成員]  。 這可讓您重新執行協調流程。

#### <a name="monitoring"></a><a name="bkmk_orch_monitor"></a> 監視
透過 Configuration Manager 主控台與[記錄檔](#log-files)監視您的協調流程群組與成員。

##### <a name="monitor-orchestration-groups"></a>監視協調流程群組

從 [資產與合規性]  工作區，選取 [協調流程群組]  節點。 新增下列任何任一欄以取得群組的相關資訊：

- **協調流程名稱**：您協調流程群組的名稱。
- **站台碼**：群組的站台碼。
- **協調流程類型**：是下列其中一種類型：
   - 數字
   - 百分比
   - 順序

- **協調流程值**：有多少個成員或多少百分比的成員會同時取得鎖定。 [協調流程值]  只會在 [協調流程類型]  為 [數字]  或 [百分比]  的情況下填入。  
- **協調流程狀態**：在協調流程期間為 [進行中]。 未進行時為 [閒置]。
- **協調流程開始時間**：協調流程開始的日期和時間。
- **目前的序號**：指出群組協調流程中的哪個成員為作用中。 此數字會與該成員的 [序號]  對應。  
- **協調流程逾時 (分鐘)** ：在建立群組時於 [一般]  頁面上，或是在編輯群組時於 [一般]  索引標籤上設定的 [協調流程群組逾時 (分鐘)]  值。
- **協調流程群組成員逾時 (分鐘)** ：在建立群組時於 [一般]  頁面上，或是在編輯群組時於 [一般]  索引標籤上設定的 [協調流程群組成員逾時 (分鐘)]  值。
- **協調流程群組識別碼**：群組的識別碼；識別碼會用於記錄檔與資料庫。
- **協調流程群組唯一識別碼**：群組的唯一識別碼；唯一識別碼會用於記錄檔與資料庫。

##### <a name="monitor-orchestration-group-members"></a>監視協調流程群組成員

在 [協調流程群組]  節點上，選取協調流程群組。 在功能區中，選取 [顯示成員]  。 您可以查看群組的成員，以及其協調流程狀態。 新增下列任一欄以取得成員的相關資訊：

- **名稱**：協調流程群組成員的裝置名稱
- **目前狀態**：為您提供成員裝置的狀態。 
   - 在協調流程期間為 [進行中]  。
   - **等待中**：指出用戶端正在等候鎖定結束並輪到其安裝更新。 
   - 在協調流程已完成或未執行時為 [閒置]  。
- **狀態碼**：您能以滑鼠右鍵按一下協調流程群組成員，然後選取 [重設協調流程群組成員]  。 此重設可讓您重新執行協調流程。 狀態包括： 
   - 閒置
   - 等候中，裝置目前正在等候
   - 進行中，正在安裝更新
   - Failed
   - 重新開機擱置中
- **鎖定取得的時間**：用戶端會根據其原則要求鎖定。 當用戶端取得鎖定時，協調流程便會在其上觸發。  
-**上次狀態回報時間**：成員上次回報狀態的時間。
- **序號**：用戶端在安裝更新之佇列中的位置。
- **站台碼**：成員的站台碼。
- **用戶端活動**：告訴您用戶端為作用中或非作用中。
- **主要使用者**：哪些使用者為裝置的主要使用者。
- **用戶端類型**：用戶端為哪種類型的裝置。
- **目前登入的使用者**：目前已登入裝置的使用者為何。
- **OG 識別碼**：成員所屬協調流程群組的識別碼。 
- **OG 唯一識別碼**：成員所屬協調流程群組的唯一識別碼。
- **資源識別碼**：裝置的資源識別碼。

#### <a name="log-files"></a>記錄檔
使用站台伺服器上的下列記錄檔來協助間監視及疑難排解：

##### <a name="site-server"></a>網站伺服器
- **Policypv.log**：顯示站台將協調流程群組的目標設定為用戶端。
- **SMS_OrchestrationGroup.log**：顯示協調流程群組的行為。

##### <a name="client"></a>用戶端

- **MaintenanceCoordinator.log**：顯示鎖定取得、更新安裝、前置和後置指令碼，以及鎖定釋放程序。
- **UpdateDeployment.log**：顯示更新安裝程序。
- **PolicyAgent.log**：檢查用戶端是否位於協調流程群組。 

#### <a name="orchestration-group-known-issues"></a>協調流程群組已知問題

- 不要將機器新增到一個以上的協調流程群組。

