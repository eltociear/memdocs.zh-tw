---
title: 建立應用程式
titleSuffix: Configuration Manager
description: 建立含有部署類型、偵測方法與安裝軟體需求的應用程式。
ms.date: 04/01/2020
ms.prod: configuration-manager
ms.technology: configmgr-app
ms.topic: conceptual
ms.assetid: cc230ff4-7056-4339-a0a6-6a44cdbb2857
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 33a95ae78fdc80c6c08b59cfe5ec5b2e88485a8f
ms.sourcegitcommit: 1442a4717ca362d38101785851cd45b2687b64e5
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2020
ms.locfileid: "82074651"
---
# <a name="create-applications-in-configuration-manager"></a>在 Configuration Manager 中建立應用程式

適用於：  Configuration Manager (最新分支)

Configuration Manager 應用程式會定義應用程式的相關中繼資料。 一個應用程式有一或多個部署類型。 這些部署類型包含在裝置上安裝軟體所需的安裝檔案和資訊。 部署類型也具有像是偵測方法和需求之類的規則。 這些規則可指定用戶端何時及如何安裝軟體。  

使用下列方法來建立應用程式：  

- 透過讀取應用程式安裝檔案的方式自動建立應用程式和部署類型：  
  - [建立應用程式](#bkmk_create)並[自動偵測](#bkmk_auto-app)應用程式資訊
  - [建立部署類型](#bkmk_create-dt)並[自動識別](#bkmk_auto-dt)部署類型資訊

- 手動建立應用程式並在之後新增部署類型：  
  - [建立應用程式](#bkmk_create)並[手動指定](#bkmk_manual-app)應用程式資訊
  - [建立部署類型](#bkmk_create-dt)並[手動指定](#bkmk_manual-dt)部署類型資訊

- 從檔案[匯入應用程式](#bkmk_import)  

本文也會包含下列資訊以設定部署類型：  

- [內容](#bkmk_dt-content)
- [工作順序](#bkmk_dt-ts)
- [偵測方法](#bkmk_dt-detect)
- [使用者體驗](#bkmk_dt-ux)
- [Requirements](#bkmk_dt-require)
- [傳回碼](#bkmk_dt-return)
- [相依性](#bkmk_dt-depend)

## <a name="create-an-application"></a><a name="bkmk_create"></a> 建立應用程式  

1. 在 Configuration Manager 主控台中，移至 [軟體程式庫]  工作區，展開 [應用程式管理]  ，然後選取 [應用程式]  節點。  

2. 在功能區的 [首頁]  索引標籤上，選取 [建立]  群組中的 [建立應用程式]  。  

接下來，自動偵測或手動指定應用程式資訊：  

- [自動偵測](#bkmk_auto-app)應用程式資訊，以建立含有單一部署類型的基本應用程式。 例如，不具相依性或需求的 Windows Installer 檔案。 使用此程序建立應用程式之後，請視需要進行編輯。 您可以新增或變更部署類型，以及新增偵測方法、相依性或需求。  

- [手動指定](#bkmk_manual-app)應用程式資訊，以建立更複雜的應用程式。 定義多個部署類型、相依性、偵測方法或需求。  

### <a name="automatically-detect-application-information"></a><a name="bkmk_auto-app"></a> 自動偵測應用程式資訊  

1. 在 [建立應用程式精靈] 的 [一般]  頁面上，選取 [從安裝檔案自動偵測此應用程式的相關資訊]  。  

2. 在 **[類型]** 下拉式清單中，選取您要用來偵測應用程式資訊的應用程式安裝檔案類型。 如需可用安裝類型的詳細資訊，請參閱 [Configuration Manager 支援的部署類型](create-applications.md#bkmk_deploy-types)。  

3. 在 [位置]  方塊中，指定您要用來偵測應用程式資訊的應用程式安裝檔案。 這個位置是網路路徑 (`\\server\share\filename`) 或存放區連結。 您必須能夠存取包含應用程式內容的網路路徑及任何子資料夾。  

    > [!IMPORTANT]  
    > 當您選取 [Windows Installer (\*.msi 檔案)]  作為應用程式類型時，站台會匯入指定資料夾中的所有檔案。 它接著會將這些檔案傳送至發佈點。 請確定指定的資料夾只包含安裝應用程式所需的檔案。 Configuration Manager 經 Microsoft 測試，可支援應用程式套件中最多 20,000 個檔案。 如果您的應用程式包含更多檔案，請考慮建立多個包含較少檔案的應用程式。  

4. 在 [建立應用程式精靈] 的 [匯入資訊]  頁面上，檢閱資訊，然後選取 [下一步]  。 必要時，可選取 [上一步]  返回並修正任何錯誤。  

5. 在 [建立應用程式精靈] 的 [一般資訊]  頁面上，指定下列資訊：  

    > [!NOTE]  
    > 如果 Configuration Manager 會從應用程式安裝檔案自動偵測到此資訊，便會在此處填入。 此外，顯示的選項可能會依您所建立的應用程式類型而有所不同。  

    - 應用程式的一般資訊，例如應用程式的 [名稱]  、[系統管理員註解]  、[發行者]  和 [軟體版本]  。 為了協助您在 Configuration Manager 主控台中尋找應用程式，請指定 [選用的參照]  ，或選取 [系統管理類別]  。  

    - **安裝程式**：指定安裝應用程式部署類型所需的安裝程式及任何必要內容。  

        > [!TIP]  
        > 如果安裝程式沒有出現，請選擇 [瀏覽]  並瀏覽至安裝程式位置。  

    - **安裝行為**：針對 Configuration Manager 安裝此部署類型的方式，選取三個選項的其中一個。 如需這些選項的詳細資訊，請參閱[使用者體驗](#bkmk_dt-ux)。  

    - **使用自動 VPN 連線 (若已設定)** ：如果您已將一個 VPN 設定檔部署至使用者啟動應用程式所在的裝置，請在應用程式啟動時連線到該 VPN。 此選項僅適用於 Windows 8.1 和 Windows Phone 8.1。 在 Windows Phone 8.1 裝置上，如果您將多個 VPN 設定檔部署至裝置，則不支援自動 VPN 連線。 如需詳細資訊，請參閱 [VPN 設定檔](../../protect/deploy-use/vpn-profiles.md)。  

    - **在裝置上為所有使用者佈建此應用程式**<!--1358310-->:針對裝置上的所有使用者，使用 Windows 應用程式套件佈建應用程式。 如需詳細資訊，請參閱[建立 Windows 應用程式](../get-started/creating-windows-applications.md#bkmk_provision)。  

       > [!Tip]  
       > 如果您要修改現有的應用程式，此設定位於 Windows 應用程式套件部署類型內容的 [使用者體驗]  索引標籤上。  

6. 選擇 [下一步]  ，並檢閱 [摘要]  頁面上的應用程式資訊，然後完成 [建立應用程式精靈]。  

新應用程式現在會出現在 Configuration Manager 主控台的 [應用程式]  節點中。 您已完成建立應用程式。

若要新增多個部署類型或設定其他設定，請參閱[建立應用程式的部署類型](#bkmk_create-dt)。  

### <a name="manually-specify-application-information"></a><a name="bkmk_manual-app"></a> 手動指定應用程式資訊  

1. 在 [建立應用程式精靈] 的 [一般]  頁面上，選取 [手動指定應用程式資訊]  ，然後選擇 [下一步]  。  

2. 指定應用程式的 [一般資訊]  ：  

    - 應用程式的 [名稱]  為必要項目，且必須少於 256 個字元。  

    - [系統管理員註解]  、[發行者]  和 [軟體版本]  是額外的中繼資料，可進一步描述應用程式。  

    - 為了協助您在 Configuration Manager 主控台中尋找應用程式，請指定 [選用的參照]  ，或選取 [系統管理類別]  。  

    - **發行日期**  

    - 選取負責此應用程式的使用者或群組作為 [擁有者]  和 [支援連絡人]  。 這些值預設會設定為您的使用者名稱。  

3. 在 [建立應用程式精靈] 的 [軟體中心]  頁面上，指定下列資訊：  

    > [!Note]  
    > 在 1902 版和較舊的版本中，此頁面的名稱為**應用程式類別目錄**。

    - **選取的語言**：在下拉式清單中，選取您要設定之應用程式的語言版本。 選擇 [新增/移除]  ，為此應用程式設定更多語言。  

    - **當地語系化的應用程式名稱**：以選取的語言指定應用程式名稱。  

        > [!IMPORTANT]  
        > 您設定的每一個語言版本都需要當地語系化的應用程式名稱。  

    - **使用者類別**：選擇 [編輯]  以選取的語言指定應用程式類別。 軟體中心的使用者使用這些類別來協助篩選和排序應用程式。  

        > [!Note]  
        > 在 1902 版和較舊的版本中，使用者類別僅適用於針對使用者集合可用的部署。 如果應用程式是部署至電腦集合，系統便會忽略使用者類別。
        >
        > 從 1906 版開始，裝置導向應用程式部署的使用者類別會在軟體中心內顯示為篩選。 這些部署可以為「可用」或「必要」。
        >
        > <!-- 4726793 -->重新命名或刪除類別並不會自動套用至具有此類別的應用程式。 這些變更會於下一次的應用程式修訂中才進行套用。 解決此重新命名或刪除問題：
        >
        > - 首先，在所有參考該類別的應用程式中，清除該類別的核取方塊。 然後套用該變更，以修改應用程式。
        >     - 接著使用新名稱建立新的類別，然後將新類別新增至相關的應用程式，而不進行重新命名動作。
        >     - 修改應用程式之後，您就可以刪除該類別。

    - **使用者文件**：指定檔案的位置，軟體中心使用者可從中取得此應用程式的詳細資訊。 這個位置是網址，或是網路路徑和檔案名稱。 確定使用者可存取此位置。  

    - **連結文字**：指定在指定使用者文件時，要取代「其他資訊」顯示的文字。  

    - **隱私權 URL**：指定應用程式隱私權聲明的網址。  

    - **當地語系化的描述**：以選取的語言輸入這個應用程式的描述。  

    - **關鍵字**：以選取的語言輸入關鍵字清單。 這些關鍵字有助於軟體中心的使用者搜尋應用程式。  

    - **圖示**：選取 [瀏覽]  以選取這個應用程式的圖示。 如果未指定圖示，Configuration Manager 會使用預設圖示。 圖示最大可為 512x512 像素尺寸。  

4. 在 [建立應用程式精靈] 的 [部署類型]  頁面上，選擇 [新增]  建立新的部署類型。 如需詳細資訊，請參閱[建立應用程式的部署類型](#bkmk_create-dt)。  

5. 選擇 [下一步]  ，並檢閱 [摘要]  頁面上的應用程式資訊，然後完成 [建立應用程式精靈]。  

新應用程式現在會出現在 Configuration Manager 主控台的 [應用程式]  節點中。  

## <a name="create-deployment-types-for-the-application"></a><a name="bkmk_create-dt"></a> 建立應用程式的部署類型  

如果您要[自動偵測應用程式資訊](#bkmk_auto-app)，可能就不需完成本節中的某些步驟。  

> [!Note]  
> 當您檢視現有部署類型的內容時，下列各節會對應至 [部署類型內容] 視窗的各索引標籤：  
>
> - [內容](#bkmk_dt-content)
> - [工作順序](#bkmk_dt-ts)
> - [偵測方法](#bkmk_dt-detect)
> - [使用者體驗](#bkmk_dt-ux)
> - [Requirements](#bkmk_dt-require)
> - [傳回碼](#bkmk_dt-return)
> - [相依性](#bkmk_dt-depend)
>  
> 如需部署類型內容之 [安裝行為]  索引標籤的資訊，請參閱[檢查是否有執行中的可執行檔](deploy-applications.md#bkmk_exe-check)。  

### <a name="start-the-create-deployment-type-wizard"></a>啟動建立部署類型精靈  

啟動 [建立部署類型精靈] 的方式有三種：

- **在 [應用程式] 節點中**：在 Configuration Manager 主控台中，移至 [軟體程式庫]  工作區，展開 [應用程式管理]  ，然後選取 [應用程式]  節點。 選取應用程式，然後選取功能區中的 [建立部署類型]  。  

- **建立應用程式時**：當您在 [建立應用程式精靈] 中[手動指定應用程式資訊](#bkmk_manual-app)時，選取 [部署類型] 頁面上的 [新增]  。  

- **從應用程式內容**：在 [應用程式]  節點中選取現有的應用程式，然後選取 [內容]  。 切換至 [部署類型]  索引標籤，然後選取 [新增]  。

然後使用下列其中一個程序[自動識別](#bkmk_auto-dt)或[手動指定](#bkmk_manual-dt)部署類型資訊。  

### <a name="automatically-identify-deployment-type-information"></a><a name="bkmk_auto-dt"></a> 自動識別部署類型資訊  

1. 在 [建立部署類型精靈] 的 [一般]  頁面上：  

    1. 選取要偵測部署類型資訊的應用程式安裝檔案 [類型]  。  

    2. 選取 [自動從安裝檔案識別此部署類型的相關資訊]  。  

    3. 在 [位置]  方塊中，指定您要用來偵測部署類型資訊的應用程式安裝檔案。 這個位置是網路路徑 (`\\server\share\filename`) 或存放區連結。 您必須能夠存取包含應用程式內容的網路路徑及任何子資料夾。  

2. 在 [建立部署類型精靈] 的 [匯入資訊]  頁面上，檢閱資訊，然後選取 [下一步]  。 必要時，可選取 [上一步]  返回並修正任何錯誤。  

3. 在 [建立部署類型精靈] 的 [一般資訊]  頁面上，指定下列資訊：  

    > [!NOTE]  
    > 可能已存在一些部署類型資訊，如果已從應用程式安裝檔案取得的話。 此外，顯示的選項可能會依您所建立的部署類型而有所不同。  

    - 部署類型的 [一般資訊]  ：  
        - 需要 [名稱]   

        - [系統管理員註解]  可進一步描述它  

        - 其可用的 [語言]   

    - **安裝程式**：指定安裝部署類型所需的安裝程式及任何內容。  

    - **安裝行為**：針對 Configuration Manager 安裝此部署類型的方式，選取三個選項的其中一個。 如需這些選項的詳細資訊，請參閱[使用者體驗](#bkmk_dt-ux)。  

    - **使用自動 VPN 連線 (若已設定)** ：如果您已將一個 VPN 設定檔部署至使用者啟動應用程式所在的裝置，請在應用程式啟動時連線到該 VPN。 此選項僅適用於 Windows 8.1 和 Windows Phone 8.1。 在 Windows Phone 8.1 裝置上，如果您將多個 VPN 設定檔部署至裝置，則不支援自動 VPN 連線。 如需詳細資訊，請參閱 [VPN 設定檔](../../protect/deploy-use/vpn-profiles.md)。  

4. 選擇 [下一步]  ，然後繼續進行[部署類型的內容選項](#bkmk_dt-content)。  

### <a name="manually-specify-the-deployment-type-information"></a><a name="bkmk_manual-dt"></a> 手動指定部署類型資訊  

1. 在 [建立部署類型] 精靈 [一般]  頁面上的 [類型]  下拉式清單中，選擇適用於此部署類型的應用程式安裝檔案類型。

2. 選取 [手動指定部署類型資訊]  ，然後選取 [下一步]  。

3. 在 [建立部署類型精靈] 的 [一般資訊]  頁面上，指定部署類型的 [名稱]  。 選擇性指定 [系統管理員註解]  ，選取此部署類型的 [語言]  ，然後選取 [下一步]  。  

4. 繼續進行[部署類型的內容選項](#bkmk_dt-content)。  

### <a name="deployment-type-content-options"></a><a name="bkmk_dt-content"></a> 部署類型的**內容**選項  

在 [內容]  頁面上，指定下列資訊：  

> [!Note]  
> 當您檢視現有部署類型的內容時，其中一些選項會出現在 [內容]  索引標籤，另一些選項會出現在 [程式]  索引標籤。  

- **內容位置**：指定這個部署類型的內容位置，或選取 [瀏覽]  選擇部署類型內容資料夾。  

    > [!IMPORTANT]  
    > 站台伺服器電腦的系統帳戶必須具有指定內容位置的權限。  

  - **將內容保存在用戶端快取中**：Configuration Manager 用戶端會將部署類型內容無限期保留在其快取中。 即使已安裝應用程式，用戶端也一樣會保存內容。 此選項在某些部署中非常有用，例如，以 Windows Installer 為基礎的軟體。 Windows Installer 需要來源內容的本機複本以套用更新。 此選項會減少可用的快取空間。 如果您選取此選項，稍後可能會因為快取沒有足夠的可用空間而造成大型部署失敗。  

- **安裝程式**：指定安裝程式的名稱以及任何必要的安裝參數。  

  - **安裝開始位置**：選擇性地指定具有該部署類型安裝程式的資料夾。 此資料夾可以是用戶端上的絕對路徑，或是含有安裝檔案之發佈點資料夾的路徑。  

- **解除安裝程式**：選擇性地指定解除安裝程式的名稱以及任何必要參數。  

  - **解除安裝開始位置**：選擇性地指定具有該部署類型解除安裝程式的資料夾。 此資料夾可以是用戶端上的絕對路徑。 它也可以是含有該套件資料夾發佈點上的相對路徑。  

- **修復程式**：針對 Windows Installer 及指令碼安裝程式的部署類型，選擇性地指定修復程式名稱和任何必要參數。<!--1357866-->  

  - **修復開始位置**：選擇性地指定具有該部署類型修復程式的資料夾。 此資料夾可以是用戶端上的絕對路徑。 它也可以是含有該套件資料夾發佈點上的相對路徑。  

- **在 64 位元用戶端上以 32 位元處理序執行安裝和解除安裝程式**：使用 Windows 電腦上的 32 位元檔案和登錄位置執行部署類型的安裝程式。  

#### <a name="deployment-type-properties-content-options"></a>部署類型內容的**內容**選項

當您檢視部署類型的內容時，下列選項只會出現在 [內容]  索引標籤：

- **解除安裝內容設定**：  

  - **與安裝內容相同**：如果安裝和解除安裝內容相同，請選取此選項。 此選項是預設值。  

  - **沒有解除安裝內容**：如果您的應用程式不需要解除安裝的內容，請選取此選項。  

  - **與安裝內容不同**：如果解除安裝內容不同於安裝內容，請選取此選項。  

    - **解除安裝內容位置**：指定用來解除安裝應用程式之內容的網路路徑。  

- **允許用戶端從預設站台界限群組使用發佈點**：指定當目前或鄰近界限群組中的發佈點沒有內容可用時，用戶端是否應該從站台預設界限群組中的發佈點下載並安裝軟體。  

- **部署選項**：指定當用戶端使用鄰近或預設站台界限群組中的發佈點時，是否應該下載應用程式。  

- **允許用戶端與同一個子網路上的其他用戶端共用內容**：指定是否要針對內容下載啟用使用 BranchCache。 如需詳細資訊，請參閱 [BranchCache](../../core/plan-design/hierarchy/fundamental-concepts-for-content-management.md#branchcache)。 用戶端一律會啟用 BranchCache。 1802 版中已移除此設定，因為用戶端會使用 BranchCache (如果發佈點支援)。  

### <a name="deployment-type-task-sequence-options"></a><a name="bkmk_dt-ts"></a> 部署類型 [工作順序]  選項

<!--3555953-->

如需從 2002 版開始的工作順序部署類型詳細資訊，請參閱[工作順序部署類型](../get-started/creating-windows-applications.md#bkmk_tsdt)。

在 [工作順序]  頁面上，指定下列資訊：

- **安裝工作順序**：選取執行此應用程式安裝程序的工作順序。

- **解除安裝工作順序** (選擇性)：選取移除此應用程式的工作順序。

> [!TIP]  
> 若您的工作順序並未出現在清單中，請再次檢查其並未包括任何 OS 部署或 OS 升級步驟。 也請確認它並未遭到標記為具強烈影響性的工作順序。 如需詳細資訊，請檢閱[工作順序部署類型](../get-started/creating-windows-applications.md#bkmk_tsdt)的先決條件。

### <a name="deployment-type-detection-method-options"></a><a name="bkmk_dt-detect"></a> 部署類型的 [偵測方法]  選項

這個程序會設定指出部署類型是否存在的偵測方法。 換句話說，Windows 裝置是否已安裝應用程式。 使用下列兩個方法之一來建立偵測方法：

- [設定規則偵測此部署類型是否存在](#bkmk_detect-rule)
- [使用自訂指令碼偵測此部署類型是否存在](#bkmk_detect-script)

#### <a name="configure-rules-to-detect-the-presence-of-this-deployment-type"></a><a name="bkmk_detect-rule"></a> 設定規則偵測此部署類型是否存在

1. 在 [偵測方法]  頁面上，預設會選取 [設定規則偵測此部署類型是否存在]  選項。 選取 [新增子句]  。  

2. 在 [偵測規則]  對話方塊中，選取一種**設定類型**來偵測部署類型是否存在：  

    - **檔案系統**：偵測指定的檔案或資料夾是否存在於裝置上。 此偵測會指出應用程式已安裝。 指定下列其他詳細資料：  

        - **類型**：選取其為檔案或資料夾。  

        - **路徑** (必要)：輸入或瀏覽至裝置上的本機路徑，其中包含檔案和資料夾。 例如 `C:\Program Files`。 您無法指定共用的網路路徑。 如果您選取 [瀏覽]  ，請瀏覽本機檔案系統或連線到具代表性的用戶端以進行瀏覽。  

        - **檔案或資料夾名稱** (必要)：指定要在上述路徑中偵測的特定檔案或資料夾名稱。 如果用戶端在裝置上偵測到此檔案或資料夾，則會將應用程式視為已安裝在裝置上。  

        - **此檔案或資料夾與 64 位元系統上的 32 位元應用程式相關聯**：預設會選取這個選項。 用戶端會先檢查 32 位元檔案位置中是否有指定的檔案或資料夾。 如果找不到檔案或資料夾，用戶端會接著搜尋 64 位元位置。  

    - **登錄**：偵測指定的登錄機碼或登錄值是否存在於用戶端裝置上。 此偵測會指出應用程式已安裝。 指定下列其他詳細資料：  

        - **登錄區** (必要)：從下拉式清單選擇登錄區。 例如 `HKEY_LOCAL_MACHINE`。  

        - **機碼** (必要)：指定要在上述登錄區中搜尋的登錄機碼。 例如 `SOFTWARE\Microsoft\Office`。  

        - **值** (選擇性)：輸入要在上述機碼中偵測的特定值。 如果您想要讓用戶端偵測 (預設) 值，請啟用 [使用 (預設) 登錄機碼值進行偵測]  選項。 當您輸入值或啟用此選項時，您必須選取 [資料類型]  。  

        - **此登錄機碼與 64 位元系統上的 32 位元應用程式相關聯**：選取此選項可先檢查指定登錄機碼的 32 位元登錄位置。 如果找不到登錄機碼，用戶端會搜尋 64 位元位置。  

    - **Windows Installer**：偵測指定的 Windows Installer 檔案是否存在於用戶端裝置上。 此偵測會指出應用程式已安裝。 指定要在用戶端上偵測的 MSI [產品代碼]  。 如果您選取 [瀏覽]  ，請選擇要從中讀取產品代碼的 MSI 檔案。

3. 在 [偵測規則] 視窗底部，指定項目是否必須存在或符合規則。 例如，如果您使用檔案進行偵測，則預設會選取下列選項：**檔案系統設定必須存在於目標系統，才能指出此應用程式是否存在**。 選取其他選項，以建立規則來根據檔案或資料夾內容進行偵測。 這些內容包括 [修改日期]、[建立日期]、[版本] 或 [大小]。 這些規則準則會因每個設定類型而有所不同。  

4. 選取 [確定]  以關閉 [偵測規則]  對話方塊。  

當您為一個部署類型建立多個偵測方法時，您可以將子句群組在一起來建立更複雜的邏輯。  

#### <a name="group-detection-clauses-optional"></a>群組偵測子句 (選擇性) 

1. 在部署類型上建立三個或多個偵測方法子句。  

2. 選取兩個或更多個連續子句，然後選取 [群組]  。 您會看到括號新增至相關聯的欄，顯示群組的開頭和結尾位置。  

    範例：

    | 連接子  |  ( | 子句           |  )。  |
    |------------|----|------------------|-----|
    |            |    | MSI 產品代碼 |     |
    | 或者         | (  | file1.text 存在|     |
    | And        |    | file2.txt 存在 | )。   |

3. 若要移除群組，選取群組子句，然後選取 [取消群組]  。  

「繼續」  進行下一節，以使用自訂指令碼作為偵測方法。 或「跳到」  部署類型的[使用者體驗](#bkmk_dt-ux)選項。

#### <a name="use-a-custom-script-to-check-for-the-presence-of-a-deployment-type"></a><a name="bkmk_detect-script"></a> 使用自訂指令碼檢查部署類型是否存在  

1. 在 [偵測方法]  頁面上，選取 [使用自訂指令碼偵測此部署類型是否存在]  方塊。 然後選取 [編輯]  。  

2. 在 [指令碼編輯器]  對話方塊中，選取 [指令碼類型]  以偵測部署類型：PowerShell、VBScript 或 JScript。  

    > [!Note]  
    > 當 Windows PowerShell 指令碼以應用程式偵測方法的形式執行時，Configuration Manager 用戶端會搭配 `-NoProfile` 參數呼叫 PowerShell。 此選項會啟動 PowerShell，但不含設定檔。 PowerShell 設定檔是在 PowerShell 啟動時執行的指令碼。 <!--3607762-->  

3. 在 [指令碼內容]  方塊中，輸入您要使用的指令碼，或貼上現有指令碼的內容。 選擇 [開啟]  以瀏覽至現有已儲存的指令碼。 選取 [清除]  以移除 [指令碼內容] 欄位中的文字。 如有必要，啟用 [在 64 位元用戶端上以 32 位元處理序執行指令碼]  選項。  

    > [!NOTE]  
    > 指令碼的大小上限為 32 KB。  

4. 選取 [確定]  以儲存指令碼並關閉 [指令碼編輯器]  對話方塊。 回到 [建立部署類型精靈]，[指令碼類型]  和 [指令碼長度]  欄位會更新為您指令碼的相關詳細資料。

#### <a name="about-custom-script-detection-methods"></a>關於自訂指令碼偵測方法  

Configuration Manager 會檢查指令碼的結果。 它會讀取指令碼寫入到標準輸出 (STDOUT) 串流、標準錯誤 (STDERR) 串流及結束代碼的值。 如果指令碼以非零值結束，代表指令碼執行失敗，且應用程式偵測狀態為「不明」  。 如果結束代碼為零而 STDOUT 含有資料，表示應用程式偵測狀態是「已安裝」  。

> [!TIP]
> 撰寫偵測指令碼時，如果您傳回零結束代碼，但未傳回輸出 (STDOUT 中的資料)，則不會偵測到應用程式為已安裝。 如需詳細資訊，請參閱下列範例。

使用下表從指令碼的輸出來檢查是否已安裝應用程式：  

##### <a name="zero-exit-code"></a>零結束代碼

|STDOUT|STDERR|指令碼結果|應用程式偵測狀態|
|---------|---------|---------|---------|
|空白|空白|成功|未安裝|
|空白|不是空白|失敗|Unknown|
|不是空白|空白|成功|已安裝|
|不是空白|不是空白|成功|已安裝|

##### <a name="non-zero-exit-code"></a>非零結束代碼

|STDOUT|STDERR|指令碼結果|應用程式偵測狀態|
|---------|---------|---------|---------|
|空白|空白|失敗|Unknown|
|空白|不是空白|失敗|Unknown|
|不是空白|空白|失敗|Unknown|
|不是空白|不是空白|失敗|Unknown|

##### <a name="examples"></a>範例

使用下列 PowerShell/VBScript 範例來撰寫您自己的應用程式偵測指令碼：  

**範例 1**：指令碼傳回的結束代碼為非零。 此代碼表示指令碼無法成功執行。 在此情形下，應用程式偵測狀態為不明。  

``` PowerShell
Exit 1
```

``` VBScript
WScript.Quit(1)
```

**範例 2**：指令碼傳回的結束代碼為零，但是 STDERR 的值不是空白。 此結果表示指令碼無法成功執行。 在此情形下，應用程式偵測狀態為不明。  

``` PowerShell
Write-Error "Script failed"
Exit 0
```

``` VBScript
WScript.StdErr.Write "Script failed"
WScript.Quit(0)
```

**範例 3**：指令碼傳回的結束代碼為零，表示已成功執行。 不過，STDOUT 的值為空白，表示未安裝應用程式。  

``` PowerShell
Exit 0
```

``` VBScript
WScript.Quit(0)
```

**範例 4**：指令碼傳回的結束代碼為零，表示已成功執行。 STDOUT 的值不是空白，表示已安裝應用程式。  

``` PowerShell
Write-Host "The application is installed"
Exit 0
```

``` VBScript
WScript.StdOut.Write "The application is installed"
WScript.Quit(0)
```

**範例 5**：指令碼傳回的結束代碼為零，表示已成功執行。 STDOUT 和 STDERR 的值不是空白，表示已安裝應用程式。  

``` PowerShell
Write-Host "The application is installed"
Write-Error "Completed"
Exit 0
```

``` VBScript
WScript.StdOut.Write "The application is installed"
WScript.StdErr.Write "Completed"
WScript.Quit(0)
```

### <a name="deployment-type-user-experience-options"></a><a name="bkmk_dt-ux"></a> 部署類型的 [使用者體驗]  選項

這些設定會指定用戶端如何在裝置上安裝應用程式，以及使用者看到的內容。  

在 [使用者經驗]  頁面上，指定下列資訊：  

- **安裝行為**：在下拉式清單中選取下列其中一個選項：  

  - **針對使用者安裝**：用戶端只會針對已部署應用程式的使用者安裝應用程式。  

  - **針對系統安裝**：用戶端只安裝應用程式一次。 所有使用者皆可使用。  

  - **如果資源是裝置，請針對系統安裝; 否則請針對使用者安裝**：如果您將應用程式部署到裝置，用戶端就只會針對所有使用者進行安裝。 如果您將應用程式部署到使用者，用戶端就只會針對該使用者進行安裝。  

- **登入需求**：選取下列其中一個選項：  

  - **只有在使用者登入時**  

  - **無論使用者是否登入**  

  - **只有在使用者未登入時**  

    > [!NOTE]  
    > 此選項預設為 [只有在使用者登入時]  。 如果您在 [安裝行為]  下拉式清單中選取 [針對使用者安裝]  ，就無法變更此選項。  

- **安裝程式可見度**：指定部署類型在用戶端裝置上執行的模式。 選取下列其中一個選項：  

  - **最大化**：部署類型會以最大化在用戶端裝置上執行。 使用者會看到所有的安裝活動。  

  - **正常**：部署類型會根據系統和程式預設值以一般模式執行。 此為預設模式。  

  - **最小化**：部署類型會以最小化在用戶端裝置上執行。 使用者可能會在通知區域或工作列看到安裝活動。  

  - **隱藏**：部署類型會在用戶端裝置上隱藏執行。 使用者不會看到安裝活動。  

- **允許使用者檢視程式安裝，並與其互動**：指定使用者是否可以與部署類型安裝互動以設定安裝選項。  

    如果您已選取 [安裝行為]  下拉式清單中的 [針對使用者安裝]  選項，此選項預設為啟用狀態。  

    > [!IMPORTANT]  
    > 當您選取 [針對系統安裝]  行為時，此為選擇性設定。 此變更主要是讓使用者能夠在工作順序期間與安裝進行互動。 例如，執行會向使用者提示各種選項的安裝程序。 某些應用程式安裝程式無法轉為無使用者提示，或者安裝流程可能需要只有使用者才知道的特定設定值。 <!--1356976-->  
    >  
    > 在系統內容中安裝及允許使用者與安裝互動不是安全的設定。 如需詳細資訊，請參閱[應用程式管理的安全性和隱私權](../plan-design/security-and-privacy-for-application-management.md#bkmk_interact)。  

- **允許的執行時間上限 (分鐘)** ：指定您預期在用戶端電腦上執行部署類型的時間上限 (分鐘)。 將此設定指定為大於零的整數。 預設值為 120 分鐘 (兩小時)。  

    使用這個值來執行下列動作：  

  - 監視部署類型的結果。  

  - 當您在用戶端裝置上定義維護期間時，檢查是否安裝某個部署類型。 已定義維護期間時，只有在維護期間有可用的時間足以包含 [允許的執行時間上限]  設定時，部署類型才會啟動。  

    > [!IMPORTANT]  
    > 如果 [允許的執行時間上限]  大於排程的維護期間則可能會發生衝突。 如果使用者將執行時間上限設定為大於任何可用維護期間長度的期間，該部署類型就不會執行。  

- **估計的安裝時間 (分鐘)** ：指定安裝部署類型所需的預估時間。 使用者會在軟體中心看到這個時間。  

#### <a name="deployment-type-properties-user-experience-options"></a>部署類型內容的 [使用者體驗]  選項

當您檢視部署類型的內容時，下列選項只會出現在 [使用者體驗]  索引標籤：

強制執行特定安裝後行為。 選取下列其中一個選項：  

- **根據傳回碼決定行為**：根據 [[傳回碼]](#bkmk_dt-return) 索引標籤上設定的代碼來處理重新開機作業。軟體中心會顯示**可能需要重新開機**。 如果使用者在安裝期間登入，系統便會根據「部署」  的 [使用者體驗] 設定來提示使用者。  

- **無特定動作**：安裝之後無需重新開機。 軟體中心會回報無需重新開機。  

- **軟體安裝程式可能會強制裝置重新啟動**：Configuration Manager 不會控制或起始重新開機，但實際的安裝可能不發出警告就重新開機。 使用此設定時，可防止 Configuration Manager 安裝程式在起始重新開機時回報安裝失敗。 軟體中心會顯示**可能需要重新開機**。  

- **Configuration Manager 用戶端將會強制裝置重新啟動**：成功安裝後，Configuration Manager 會強制裝置重新開機。 軟體中心會回報需要重新開機。 如果使用者在安裝期間登入，系統便會根據「部署」  的 [使用者體驗] 設定來提示使用者。  

### <a name="deployment-type-requirements"></a><a name="bkmk_dt-require"></a> 部署類型 [需求] 

Configuration Manager 會先驗證裝置上的這些需求，再安裝部署類型。 使用需求以進一步調整並控制接收此應用程式的裝置或使用者。 在此範例中，如果您將應用程式部署到使用者集合，請指定這裡的應用程式硬體需求。

1. 在 [需求]  頁面上，選取 [新增]  以開啟 [建立需求]  對話方塊。  

2. 在 [類別]  下拉式清單中，選取此需求是針對 [裝置]  或 [使用者]  。  

    選取 [自訂]  ，以使用之前建立的全域條件。 當您選取 [自訂]  時，您也可以選擇 [建立]  以建立新的全域條件。 如需全域條件的詳細資訊，請參閱[如何建立全域條件](create-global-conditions.md)。  

    > [!IMPORTANT]  
    > 如果您將應用程式部署至裝置集合，用戶端就會略過 [使用者]  類別和 [主要裝置]  條件的任何需求。  

3. 在 [條件]  下拉式清單中，選取用來評估使用者或裝置是否符合安裝需求的條件。 此清單的內容會依選取的類別而有所不同。  

4. 在 [運算子]  下拉式清單中，選取要使用的運算子。 此運算子會比較所選條件和指定值。 它會評估使用者或裝置是否符合安裝需求。 可用的運算子會依所選條件而有所不同。  

    > [!Note]  
    > 可用的需求會依部署類型使用的裝置類型而有所不同。  

5. 在 [值]  方塊中，指定要用於比較的值。 這些值以及所選條件和運算子，會評估使用者或裝置是否符合安裝需求。 可用的值會依所選條件和所選運算子而有所不同。  

6. 選擇 [確定]  以儲存需求，然後關閉 [建立需求]  對話方塊。  

### <a name="deployment-type-dependencies"></a><a name="bkmk_dt-depend"></a> 部署類型 [相依性]   

相依性會從用戶端安裝此部署類型之前必須先行安裝的其他應用程式中，定義一或多個部署類型。

> [!IMPORTANT]  
> 在某些情況下，部署類型會相依於另一個同樣也含有相依性的部署類型。 鏈結中支援的最大相依性數目為 5。  

1. 在 [相依性]  頁面上，選取 [新增]  。  

2. 在 [新增相依性] 視窗中，輸入 [相依性群組名稱]  。 此名稱是指這組應用程式相依性。  

3. 在 [新增相依性] 視窗中，選取 [新增]  。  

4. 在 [指定必要的應用程式]  視窗中，選取可用的應用程式及其用作相依性的至少一個部署類型。  

    > [!TIP]  
    > 選取 [檢視]  以顯示所選取應用程式或部署類型的內容。  

5. 選取 [確定]  以關閉 [指定必要的應用程式]  視窗。  

6. 如果您想要讓用戶端自動安裝相依應用程式，請選取相依性旁的 [自動安裝]  。  

    > [!NOTE]  
    > 您不需要部署相依應用程式讓用戶端自動進行安裝。  

7. 如果您新增多個相依性，請使用 [增加優先順序]  和 [降低優先順序]  按鈕。 這些動作會變更用戶端評估各個相依性的順序。  

8. 選取 [確定]  以關閉 [新增相依性]  視窗。  

### <a name="deployment-type-return-codes"></a><a name="bkmk_dt-return"></a> 部署類型 [傳回碼] 

> [!Note]  
> 此頁面不在 [建立部署類型精靈] 中。 它只是現有部署類型內容的一個索引標籤。  

在部署類型完成之後，指定用來控制行為的傳回碼。 例如，指出需要重新啟動、安裝完成。

1. 在 [部署類型內容] 視窗的 [傳回碼]  索引標籤上，選取 [新增]  。  

2. 在 [新增傳回碼] 視窗中，指定此部署類型的預期 [傳回碼值]  。 此值為介於 `-2147483648` 與 `2147483647` 之間的任何正負整數。  

3. 從下拉式清單中選取 [代碼類型]  。 此設定會定義 Configuration Manager 如何從此部署類型解譯指定的傳回碼。 可用的類型會依部署類型技術而有所不同。  

    - **成功 (未重新開機)** ：部署類型已成功安裝，不需要重新開機。  

    - **失敗 (未重新開機)** ：部署類型無法安裝。  

    - **強制重新開機**：部署類型已成功安裝，但需要裝置重新啟動。 在裝置重新啟動之前，無法安裝任何項目。  

    - **軟開機**：部署類型已成功安裝，但需要裝置重新啟動。 在裝置重新啟動之前，可進行其他安裝。  

    - **快速重試**：裝置上已有其他安裝正在進行。 用戶端會每兩小時重試一次，總計 10 次。  

4. 選擇性輸入此傳回碼的 [名稱]  與 [描述]  。

5. 選取 [確定]  以關閉 [新增傳回碼] 視窗。  

#### <a name="example-non-zero-success"></a>範例：非零成功

您要部署的應用程式在成功安裝時傳回結束代碼 `1`。 根據預設，Configuration Manager 會偵測此非零傳回碼為失敗。 將 [傳回碼值] 指定為 `1`，並針對 [程式碼類型] 選取 [成功 (未重新開機)]  。 現在，Configuration Manager 會將該傳回碼解譯為此部署類型成功。

#### <a name="default-return-codes"></a>預設傳回碼

當您建立一些部署類型時，Configuration Manager 會自動新增該技術常見的下列傳回碼：  

##### <a name="windows-installer-msi-file"></a>Windows Installer (\*.msi 檔案)

|值    |代碼類型|
|---------|---------|
|0        |成功 (未重新開機)|
|1707     |成功 (未重新開機)|
|3010     |軟開機|
|1641     |強制重新開機|
|1618     |快速重試|

##### <a name="script-installer"></a>指令碼安裝程式

|值    |代碼類型|
|---------|---------|
|0        |成功 (未重新開機)|
|1641     |強制重新開機|
|3010     |軟開機|
|1618     |快速重試|

##### <a name="windows-app-package-appx-appxbundle-msix-msixbundle"></a>Windows 應用程式套件 (\*.appx、\*.appxbundle、\*.msix 和 \*.msixbundle)

|值    |代碼類型|
|---------|---------|
|15605    |快速重試|
|15618    |快速重試|

## <a name="additional-options-for-app-v-deployment-types"></a><a name="bkmk_appv"></a> App-V 部署類型的其他選項  

設定虛擬應用程式 (App-V) 部署類型特有的額外選項。  

### <a name="app-v-deployment-type-content-options"></a><a name="bkmk_appv-content"></a> App-V 部署類型的 [內容]  選項  

1. 在 Configuration Manager 主控台中，移至 [軟體程式庫]  工作區，展開 [應用程式管理]  ，然後選取 [應用程式]  節點。  

2. 選取具有 App-V 部署類型的應用程式，然後選取 [內容]  。  

3. 在應用程式內容中，切換至 [部署類型]  索引標籤。選取 App-V 部署類型，然後選取 [編輯]  。  

4. 在部署類型內容中，切換至 [內容]  索引標籤。視需要設定下列選項：  

    - **將內容保存在用戶端快取中**：Configuration Manager 用戶端不會從其快取中刪除此部署類型的內容。  

    - **啟動前將內容載入至 App-V 快取**：應用程式啟動之前，Configuration Manager 用戶端會將此部署類型的所有內容載入至 App-V 快取。 用戶端不會將內容釘選到快取中。 它會視需要刪除內容。  

5. 選取 [確定]  以關閉部署類型內容。 然後選取 [確定]  以關閉應用程式內容。  

### <a name="app-v-deployment-type-publishing-options"></a><a name="bkmk_appv-pub"></a> App-V 部署類型的 [發佈]  選項

1. 在 Configuration Manager 主控台中，移至 [軟體程式庫]  工作區，展開 [應用程式管理]  ，然後選取 [應用程式]  節點。  

2. 選取具有 App-V 部署類型的應用程式，然後選取 [內容]  。  

3. 在應用程式內容中，切換至 [部署類型]  索引標籤。選取 App-V 部署類型，然後選取 [編輯]  。  

4. 在部署類型內容中，切換至 [發佈]  索引標籤。選取您想要發佈的虛擬應用程式項目。  

5. 選取 [確定]  以關閉部署類型內容。 然後選取 [確定]  以關閉應用程式內容。  

## <a name="import-an-application"></a><a name="bkmk_import"></a> 匯入應用程式  

請使用下列程序將應用程式匯入 Configuration Manager 中：

1. 在 Configuration Manager 主控台中，移至 [軟體程式庫]  工作區，展開 [應用程式管理]  ，然後選取 [應用程式]  節點。  

2. 在功能區的 [首頁]  索引標籤上，選取 [建立]  群組中的 [匯入應用程式]  。  

3. 在 [匯入應用程式精靈] 的 [一般]  頁面上，指定所要匯入 [檔案]  的網路路徑。 例如 `\\server\share\file.zip`。 此檔案是已匯出 Configuration Manager 應用程式的有效壓縮封存 (ZIP 格式)。  

4. 在 [檔案內容]  頁面上，選取此應用程式是現有應用程式重複項時所要採取的動作。 建立新的應用程式，或是略過重複項，並新增現有應用程式的新修訂版。  

5. 在 [摘要]  頁面上，檢閱動作，然後完成精靈。  

新的應用程式會出現在 [應用程式]  節點中。  

> [!TIP]  
> Windows PowerShell Cmdlet **Import-CMApplication** 具有與此程序相同的功能。 如需詳細資訊，請參閱 [Import-CMApplication](https://docs.microsoft.com/powershell/module/configurationmanager/import-cmapplication?view=sccm-ps) \(英文\)。  

如需如何匯出應用程式的詳細資訊，請參閱[應用程式的管理工作](management-tasks-applications.md)。

## <a name="supported-deployment-types"></a><a name="bkmk_deploy-types"></a> 支援的部署類型  

Configuration Manager 支援下列應用程式部署類型：

| 部署類型名稱 | 說明 |
|--------------------------|----------------------|  
| **Windows Installer (\*.msi 檔案)** | Windows Installer 檔案。 |  
| **Windows 應用程式套件 (\*.appx、\*.appxbundle、\*.msix、\*.msixbundle)** | Windows 應用程式套件檔案 (.appx)、Windows 應用程式套件組合套件 (.appxbundle)、Windows 10 應用程式套件 (.msix) 或 Windows 10 應用程式套件組合 (.msixbundle)。<!--1357427--> |  
| **Windows 應用程式套件 (在 Windows 市集中)** | 指定連往 Windows 市集中應用程式的連結，或瀏覽市集以選取應用程式。<sup>[附註 1](#bkmk_note1)</sup> |  
| **指令碼安裝程式** | 指定在 Windows 用戶端上執行的指令碼或程式，用來安裝內容或執行動作。 針對 setup.exe 安裝程式或指令碼包裝函式使用此部署類型。 |  
| **Microsoft Application Virtualization 4** | Microsoft App-V v4 資訊清單。 |  
| **Microsoft Application Virtualization 5** | Microsoft App-V v5 套件檔案。 |  
| **Windows Phone 應用程式套件 (\*.xap 檔案)** | Windows Phone 應用程式套件檔案。 |  
| **Windows Phone 應用程式套件 (在 Windows Phone 市集中)** | 指定連往 Windows 市集中應用程式的連結。 |  
| **Mac OS X** | 適用於執行 Configuration Manager 用戶端的 macOS 電腦。 使用 **CMAppUtil** 工具建立 .cmmac 檔案。 |  
| **Web 應用程式** | 指定連往 Web 應用程式的連結。 這項部署類型可在使用者裝置上安裝通往 Web 應用程式的捷徑。 |  
| **透過 MDM 的 Windows Installer (\*.msi)** | 建立以 Windows Installer 為基礎的應用程式並將其部署到 Windows 10 裝置。 如需詳細資訊，請參閱[將 Windows Installer 應用程式部署到已註冊 MDM 的 Windows 10 裝置](../get-started/creating-windows-applications.md#bkmk_mdm-msi)。 |
| **工作順序** | 從 2002 版開始，請使用工作順序來安裝或解除安裝複雜的應用程式。 如需詳細資訊，請參閱[工作順序部署類型](../get-started/creating-windows-applications.md#bkmk_tsdt)。 <!--3555953--> |

> [!NOTE]
> Configuration Manager 主控台可能會顯示其他部署類型，但這些類型適用於不再支援的平台。 如需詳細資訊，請參閱[混合式有哪些改變？](../../mdm/understand/what-happened-to-hybrid.md)。

### <a name="note-1-windows-app-package-in-the-windows-store"></a><a name="bkmk_note1"></a> 附註 1：Windows 應用程式套件 (在 Windows 市集中)

若要部署應用程式作為連往 Windows 市集的連結，請設定群組原則 [關閉市集應用程式]  。 將此原則設定為 [已停用]  或 [未設定]  。 如果您啟用此設定，用戶端就無法連線至 Windows 市集來下載和安裝應用程式。

Windows 用戶端一律會在其他部署類型之前評估使用連往存放區之連結的部署類型。 然後用戶端會依優先順序評估部署類型。

> [!TIP]
> 某些市集連結可能會在 [建立應用程式精靈] 中導致下列錯誤：「應用程式連結無效」。 例如，某些存放區「精選應用程式」  可能會引發此錯誤。 您仍然可以在精靈的 [一般]  頁面上選取 [下一步]  。 Configuration Manager 成功建立應用程式後，您便可以成功部署該應用程式。<!-- SCCMDocs-pr #4716 -->

## <a name="next-steps"></a>後續步驟

在 Configuration Manager 中建立應用程式之後，下一個步驟就是[部署應用程式](deploy-applications.md)。

從 1906 版開始，建立您可以作為單一部署傳送給使用者或裝置集合的應用程式群組。 如需詳細資訊，請參閱[建立應用程式群組](create-app-groups.md)。

如需在不同 OS 平台上建立應用程式的詳細資訊，請參閱下列文章：  

- [建立 Windows 應用程式](../get-started/creating-windows-applications.md)
- [建立 Mac 應用程式](../get-started/creating-mac-computer-applications.md)
- [建立 Linux 和 UNIX 伺服器應用程式](../get-started/creating-linux-and-unix-server-applications.md)
- [建立 Windows Embedded 應用程式](../get-started/creating-windows-embedded-applications.md)
