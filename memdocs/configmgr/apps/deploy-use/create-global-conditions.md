---
title: 建立全域條件
titleSuffix: Configuration Manager
description: 建立全域條件，指定如何提供應用程式並將其部署至用戶端裝置。
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.technology: configmgr-app
ms.topic: conceptual
ms.assetid: 2d5f871a-19dc-4bd3-a3ad-4230c7a69f1b
author: aczechowski
manager: dougeby
ms.author: aaroncz
ms.openlocfilehash: ae27e50e5093d7443c35df33b1757caec6086627
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/21/2020
ms.locfileid: "81689536"
---
# <a name="how-to-create-global-conditions-in-configuration-manager"></a>如何在 Configuration Manager 中建立全域條件

適用於：  Configuration Manager (最新分支)

在 Configuration Manager 中，全域條件就是代表商業或技術條件的規則，您可以使用這些條件來指定在用戶端裝置上提供及部署應用程式的方式。 全域條件可以從 [建立部署類型精靈] 的 [需求]  頁面中存取。  

> [!NOTE]  
>  您只能從建立全域條件的站台編輯這些條件。  

 使用下列程序，建立 Configuration Manager 全域條件。  

## <a name="provide-basic-information-about-the-global-condition"></a>提供關於全域條件的基本資訊  
 目前有數種不同類型的全域條件可供使用。 不同的選項會與不同的全域條件類型相關聯。 當您選取特定全域條件類型時，Configuration Manager 會顯示套用至選取範圍的選項。  

1.  在 Configuration Manager 主控台中，選擇 [軟體程式庫]   > [應用程式管理]   > [全域條件]  。  

3.  在 [首頁]  索引標籤的 [建立]  群組中，選擇 [建立全域條件]  。  

4.  在 [建立全域條件]  對話方塊中，提供全域條件的名稱和選擇性描述。  

5.  在 [裝置類型]  下拉式清單中，選擇全域條件適用於 [Windows]  電腦或 [Windows Mobile]  裝置。  

6.  在 [條件類型]  下拉式清單中，選擇下列其中一個選項：  

    -   **設定** – 此選項會檢查用戶端裝置上是否存在一個或多個項目。 例如，您可以檢查存在於用戶端裝置上的檔案、資料夾或登錄機碼值。  

    -   **運算式** – 此選項可讓您設定更複雜的規則來檢查用戶端裝置上的條件是否已滿足。 例如，您可以檢查電腦上的實體記憶體是介於 2 GB 至 4 GB 之間，或行動裝置是否使用觸控式螢幕輸入。  

## <a name="set-up-rules-for-the-global-condition"></a>設定全域條件的規則  
 定義全域條件規則的程序會依您是設定設定值或運算式而有所不同。 使用此處適用的程序來設定全域條件的設定值或運算式。  

### <a name="to-set-up-a-setting-for-the-global-condition"></a>設定全域條件的設定值  

1. 在 [條件類型]  下拉式清單中，選擇 [設定]  。  

2. 在 [設定類型]  下拉式清單中，選擇要用作檢查需求的條件的項目。 下列是可用的設定類型和設定。  

   - **Active Directory 查詢**  

     -   **LDAP 首碼** - 為 Active Directory 網域服務查詢指定有效的 LDAP 首碼，以評估用戶端電腦上的相容性。 您可以使用 **LDAP://** 或 **GC://** 。  

     -   **辨別名稱 (DN)** - 針對將要在用戶端電腦上評估合規性的 Active Directory 網域服務物件指定辨別名稱。  

     -   **搜尋篩選器** - 指定選擇性 LDAP 篩選器以縮小 Active Directory 網域服務查詢的結果搜尋範圍，以評估用戶端電腦上的相容性。  

     -   **搜尋範圍** - 指定 Active Directory 網域服務中的搜尋範圍：  

         -   **基本** - 僅查詢指定的物件。  

         -   **單層** - 在此 Configuration Manager 版本中不使用此選項。  

         -   **樹狀子目錄** - 查詢指定的物件以及該物件在目錄中的完整樹狀子目錄。  

     -   **內容** - 指定將用來在用戶端電腦上評估相容性的 Active Directory 網域服務物件的內容。  

     -   **查詢** - 顯示從 [LDAP 首碼]  、[辨別名稱 (DN)]  、[搜尋篩選器]\  (若已指定) 和 [內容]  中之項目建構的 LDAP 查詢。 此查詢將用來評估用戶端電腦上的合規性。  

   - **組件**  

     -   **組件名稱** - 指定要搜尋的組件物件名稱。 該名稱不可與相同類型的任何其他組件物件名稱相同，且必須在全域組件快取中登錄。 組件名稱的長度上限為 256 個字元。  

     > [!NOTE]  
     >  該組件是可在應用程式間共用的一組代碼。 組件可有 .dll 或 .exe 副檔名。 全域組件快取是用戶端電腦上名為 *%systemroot%\assembly* 的資料夾，當中儲存所有共用的組件。  

   - **檔案系統**  

     - **類型** – 從下拉式清單中選擇您要搜尋的 [檔案]  或 [資料夾]  。  

     - **路徑** - 指定用戶端電腦上所指定檔案或資料夾的路徑。 您可以指定系統環境變數和路徑中的 *%USERPROFILE%* 環境變數。  

       > [!NOTE]  
       >  如果您在 [路徑]  或 [檔案或資料夾名稱]  欄位中使用 **%USERPROFILE%** 環境變數，則會搜尋用戶端電腦上的所有使用者設定檔。 這樣可能會探索檔案或資料夾的多個執行個體。  

     - **檔案或資料夾名稱** - 指定要搜尋的檔案或資料夾物件的名稱。 您可以指定系統環境變數和檔案或資料夾名稱中的 *%USERPROFILE%* 環境變數。 您也可以在檔案中使用 萬用字元 * 和 ?。  

       > [!NOTE]  
       >  如果您指定檔案或資料夾名稱並使用萬用字元，這可能會產生大量的結果。 這可能導致大量耗用用戶端電腦上的資源，並且在向 Configuration Manager 報告結果時會產生相當高的網路流量。  

     - **包含子資料夾** – 如果您同時需要搜尋指定路徑下的任何子資料夾，可啟用此選項。  

     - **此檔案或資料夾已與 64 位元應用程式相關聯** - 選擇除了在執行 Windows 64 位元版本的 Configuration Manager 用戶端上的 32 位元系統檔案位置 ( *%windir%* \syswow64) 以外，是否也應搜尋 64 位元系統檔案位置 ( *%windir%* \system32)。  

       > [!NOTE]  
       >  如果同一部 64 位元電腦上的 64 位元和 32 位元系統檔案位置中同時存在相同的檔案或資料夾，則全域條件將會探索多個檔案。  

       [檔案系統]  設定類型不支援在 [路徑]  欄位中將 UNC 路徑指定為網路共用。  

   - **IIS Metabase**  

     -   **Metabase 路徑** - 指定 IIS Metabase 的有效路徑。  

     -   **內容識別碼** - 指定 IIS Metabase 設定的數值內容。  

   - **登錄機碼**  

     -   **登錄區** – 從下拉式清單選擇您要搜尋的登錄區。  

     -   **機碼** - 指定您要搜尋的登錄機碼名稱。 使用的格式應為 *機碼\子機碼*。  

     -   **此登錄機碼已與 64 位元應用程式相關聯** - 指定除了在執行 Windows 64 位元版本的用戶端上的 32 位元登錄機碼以外，是否也應搜尋 64 位元登錄機碼。  

         > [!NOTE]  
         >  如果同一部 64 位元電腦上的 64 位元和 32 位元登錄位置中同時存在相同的登錄機碼，則對於兩個登錄機碼全域條件都會探索。  

   - **登錄值**  

     -   **登錄區** - 從下拉式清單選取您要在其中搜尋的登錄區。  

     -   **機碼** - 指定您要搜尋的登錄機碼名稱。 使用的格式應為 *機碼\子機碼*。  

     -   **值** – 指定必須包含在所指定登錄機碼中的值。  

     -   **此登錄機碼已與 64 位元應用程式相關聯** - 指定除了在執行 Windows 64 位元版本的用戶端上的 32 位元登錄機碼以外，是否也應搜尋 64 位元登錄機碼。  

         > [!NOTE]  
         >  如果同一部 64 位元電腦上的 64 位元和 32 位元登錄位置中同時存在相同的登錄機碼，則對於兩個登錄機碼全域條件都會探索。  

   - **指令碼**  

     -   **探索指令碼** – 選擇 [新增]  以輸入或瀏覽至要使用的指令碼。 您可以使用 Windows PowerShell、VBScript 或 JScript 指令碼。  

     -   **使用登入的使用者認證來執行指令碼** – 如果您啟用此選項，指令碼會使用登入的使用者認證在用戶端電腦上執行。  

         > [!NOTE]  
         >  指令碼傳回的值可用來評估全域條件的合規性。 例如，當您使用 VBScript 時，您可以使用 **WScript.Echo Result** 命令將結果變數值傳回至全域條件。  
         >   
         >  如果您的指令碼傳回多個值，則這些值必須在單一行中並以分號分隔。 如果每個值都在不同行，評估便會失敗。  

   - **SQL 查詢**  

     -   **SQL Server 執行個體** – 選擇要在預設執行個體、所有執行個體還是指定的資料庫執行個體名稱上執行 SQL 查詢。  

         > [!NOTE]  
         >  執行個體名稱必須參考 SQL Server 的本機執行個體。 若要參考叢集 SQL Server 執行個體，您應使用指令碼設定。  

     -   **資料庫** - 指定將執行 SQL 查詢的 Microsoft SQL Server 資料庫名稱。  

     -   **資料行** - 指定 Transact-SQL 陳述式傳回的資料行名稱，以用來評估全域條件的相容性。  

     -   **Transact-SQL 陳述式** – 指定用於全域條件的完整 SQL 查詢。 您也可以選擇 [開啟]  來開啟現有的 SQL 查詢。  

   - **WQL 查詢**  

     -   **命名空間** - 指定將用來建立 WQL 查詢以評估用戶端電腦相容性的 WMI 命名空間。 預設值為 Root\cimv2。  

     -   **類別** - 指定將用來建立 WQL 查詢以評估用戶端電腦相容性的 WMI 類別。  

     -   **內容** - 指定將用來建立 WQL 查詢以評估用戶端電腦相容性的 WMI 內容。  

     -   **WQL 查詢 WHERE 子句** - 您可以使用 [WQL 查詢 WHERE 子句]  項目來指定 WHERE 子句，以套用至用戶端電腦上指定的命名空間、類別和內容。  

   - **XPath 查詢**  

     -   **路徑** - 指定 XML 檔案在用戶端電腦上的路徑以用來評估相容性。 Configuration Manager 支援在路徑名稱中使用所有 Windows 系統環境變數和 *%USERPROFILE%* 使用者變數。  

     -   **XML 檔案名稱** - 指定包含 XML 查詢的檔案名稱以用來評估用戶端電腦的合規性。  

     -   **包含子資料夾** - 如果您需要同時搜尋指定路徑下的任何子資料夾，可啟用此選項。  

     -   **此檔案與 64 位元應用程式相關聯** - 選擇除了在執行 Windows 64 位元版本的 Configuration Manager 用戶端上的 32 位元系統檔案位置 ( *%windir%* \syswow64) 以外，是否也應搜尋 64 位元系統檔案位置 ( *%windir%* \system32)。  

     -   **XPath 查詢** - 指定有效的完整 XML 路徑語言 (XPath) 查詢以用來評估用戶端電腦的相容性。  

     -   **命名空間** - 開啟 [XML 命名空間]  對話方塊，以識別 XPath 查詢期間使用的命名空間和首碼。  

3. 在 [資料類型]  下拉式清單中，選擇條件在用來檢查需求之前傳回資料所使用的格式。  

   > [!NOTE]  
   >  並非所有設定類型都會顯示 [資料類型]  下拉式清單。  

4. 在 [設定類型]  下拉式清單下方設定與此設定相關的更多詳細資料。 可設定的項目會依所選取的設定類型而有所不同。  

5. 選擇 [確定]  以儲存規則，然後關閉 [建立全域條件]  對話方塊。  

### <a name="set-up-an-expression-for-the-global-condition"></a>設定全域條件的運算式  

1.  在 [條件類型]  下拉式清單中，選擇 [運算式]  。  

2.  選擇 [新增子句]  以開啟 [新增子句]  對話方塊。  

3.  在 [選取類別]  下拉式清單中，選取要將此運算式用於裝置或使用者。 或者，您也可以選取 [自訂]  以使用之前設定的全域條件。  

4.  從 [選取條件]  下拉式清單中，選取您要用來評估使用者或裝置是否符合規則需求的條件。 此清單的內容會依選取的類別而有所不同。  

5.  從 [選擇運算子]  下拉式清單，選擇將用來比較所選條件和指定值的運算子，以評估使用者或裝置是否符合規則需求。 可用的運算子會依所選條件而有所不同。  

6.  在 [值]  欄位中，指定將與所選取條件和運算子搭配使用的值，以評估使用者或裝置是否符合規則需求。 可用的值會依所選條件和所選運算子而有所不同。  

7.  選擇 [確定]  以儲存運算式，然後關閉 [新增子句]  對話方塊。  

8.  在完成將子句新增至全域條件的步驟後，選擇 [確定]  以關閉 [建立全域條件]  對話方塊並儲存全域條件。  
