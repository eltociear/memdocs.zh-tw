---
title: 部署工作順序
titleSuffix: Configuration Manager
description: 使用下列資訊，將工作順序部署到集合中的電腦。
ms.date: 11/29/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: b2abcdb0-72e0-4c70-a4b8-7827480ba5b2
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: c2347275ffdc194e73cf792d6f83ffa75732f8c4
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/21/2020
ms.locfileid: "81691126"
---
# <a name="deploy-a-task-sequence"></a>部署工作順序

適用於：  Configuration Manager (最新分支)

您建立工作順序並發布參考內容之後，將它部署至裝置集合。 此動作可讓工作順序在裝置上執行。 已部署的工作順序可以自動執行，或在裝置使用者安裝時執行。

> [!WARNING]  
> 您可以管理高風險工作順序部署的行為。 高風險部署是一種會自動安裝的部署，而且可能會造成不需要的結果。 例如，部署 OS 的工作順序，其用途若為 [必要]  ，就會被視為高風險的部署。 如需詳細資訊，請參閱 [Settings to manage high-risk deployments](../../core/servers/manage/settings-to-manage-high-risk-deployments.md) (高風險部署的管理設定)。  

## <a name="process"></a>程序

利用下列程序，將工作順序部署到集合中的電腦。  

> [!NOTE]  
> 工作順序部署的狀態訊息會顯示在主要站台的訊息視窗中，但不會顯示在管理中心網站上。  

1. 在 Configuration Manager 主控台中，移至 [軟體程式庫]  工作區，展開 [作業系統]  ，然後選取 [工作順序]  節點。  

2. 在 [工作順序]  清單中，選取要部署的工作順序。  

3. 在功能區 [常用]  索引標籤上的 [部署]  群組中，選取 [部署]  。  

    > [!NOTE]  
    > 如果沒有 [部署]  可供使用，表示工作順序含有無效的參考。 修正參照，然後再嘗試部署工作順序。  

4. 在 [一般]  頁面上，指定下列資訊。  

    - **工作順序**：指定要部署的工作順序。 此方塊預設會顯示所選取的工作順序。  

    - **集合**：選取包含要執行工作順序之電腦的集合。  

        請勿部署將 OS 安裝到不適當集合 (例如您所有資料中心伺服器的集合) 的工作順序。 確定所選集合只包含您想要執行工作順序的電腦。  

        如需高風險部署的詳細資訊，請參閱[高風險部署](#bkmk_high-risk)。

    - **使用與此集合相關聯的預設發佈點群組**：在集合的預設發佈點群組上儲存工作順序內容。 如果您還沒有為所選的集合及發佈點群組建立關聯，便無法使用此選項。  

    - **自動發佈相依性的內容**：如果有任何參考的內容具有相依性，則站台也會將相依內容傳送到發佈點。  

    - **預先下載此工作順序的內容**：如需詳細資訊，請參閱[設定預先快取內容](configure-precache-content.md)。  

    - **選取部署範本**：針對工作順序儲存並指定部署範本。<!--1357391-->  

        > [!IMPORTANT]  
        > 某些項目不會儲存在範本中。<!--510610--> 執行部署精靈時，請務必套用下列項目：  
        >
        > - 軟體安裝
        > - 排程
        > - 預先下載內容

    - **註解 (選用)** ：指定描述此工作順序部署的其他資訊。  

5. 在 [部署設定]  頁面上，指定下列資訊：  

    - **目的**：從下拉式清單中選擇下列其中一個選項：  

        - **可供使用**：使用者會在「軟體中心」看到該工作順序，並可依需求安裝該工作順序。  

        - **必要**：Configuration Manager 會根據所設定的排程，自動執行該工作順序。 如果工作順序未隱藏，則使用者仍可追蹤其部署狀態。 他們也可以在期限之前，使用「軟體中心」來安裝工作順序。  

        > [!NOTE]
        > 如果多個使用者登入裝置，則套件和工作順序部署可能不會出現在軟體中心中。  

    - **提供給下列項目使用**：指定工作順序是否可供下列其中一種類型使用：  

        - 僅 Configuration Manager 用戶端  
        - Configuration Manager 用戶端、媒體與 PXE  
        - 僅媒體與 PXE  
        - 僅媒體與 PXE (隱藏)  

        > [!IMPORTANT]  
        > 為自動工作順序部署使用 [僅媒體和 PXE (隱藏)]  設定。 若要讓電腦能在沒有使用者互動的情況下於自動開機時進入部署，請選取 [允許自動部署作業系統]  ，然後將 **SMSTSPreferredAdvertID** 變數設定為媒體的一部分。 如需有關工作順序變數的詳細資訊，請參閱[工作順序變數](../understand/task-sequence-variables.md#SMSTSPreferredAdvertID)。  

    - **傳送喚醒封包**：如果部署是 [必要]  部署且您選取此選項，站台就會在用戶端執行部署之前，將喚醒封包傳送給電腦。 此封包會在到達安裝期限時，將電腦從睡眠中喚醒。 使用此選項之前，必須先針對 [網路喚醒] 設定電腦和網路。 如需詳細資訊，請參閱[規劃如何喚醒用戶端](../../core/clients/deploy/plan/plan-wake-up-clients.md)。  

    - **允許計量付費網際網路連線上的用戶端在安裝期限之後下載內容 (可能會產生額外費用)** ：此選項僅適用於 [必要]  部署。 當您擁有的自訂工作順序會安裝應用程式，但不會部署 OS 時，您可以指定在用戶端使用計量付費網際網路連線的情況下，是否要允許這些用戶端在安裝期限後下載內容。 當您處於計量付費網際網路連線時，網際網路提供者有時會依據您使用的資料量來收取費用。  

        > [!NOTE]  
        > 雖然使用計量付費網際網路連線對於不部署 OS 的工作順序可能可行，但不支援此做法。  

6. 在 [排程]  頁面中指定下列資訊：  

    > [!IMPORTANT]  
    > 當 Windows PE 用戶端從 PXE 或開機媒體啟動時，用戶端不會評估部署排程。 這些排程包括開始、到期或期限時間。 請只設定排程來部署至從完整 Windows OS 啟動的用戶端。 考慮使用其他方法 (例如維護視窗) 來控制部署至從 Windows PE 啟動之用戶端的作用中工作順序。  

    - **排程此部署的可用時間**：指定工作順序可在目的地電腦上執行的日期和時間。 當您選取 [UTC]  選項時，工作順序會同時可供多部電腦使用。 否則部署會根據每部電腦的當地時間，在不同的時間可供使用。  

        如果開始時間在所需時間之前，用戶端就會在開始時間下載工作順序內容。  

    - **排程此部署的到期時間**：指定工作順序在目的地電腦上的到期日期和時間。 當您選取 [UTC]  選項時，工作順序會在多部目的地電腦上同時到期。 否則部署會根據每部電腦的當地時間，在不同的時間到期。  

    - **指派排程**：針對 [必要]  部署，請指定用戶端執行工作順序的時機。 您可以新增多個排程。 指派排程可以有下列其中一個設定：  

        - 特定的日期與時間  
        - 每月、每週或自訂定期模式  
        - 盡快  
        - 登入或登出事件  

        > [!NOTE]  
        > 如果您為某個必要部署排定的開始時間早於工作順序可供使用的日期與時間，Configuration Manager 用戶端便會在指派的開始時間下載內容。 即使您將工作順序排定在稍後的時間可供使用，也會發生此行為。<!--SCCMDocs issue 777-->  

    - **重新執行行為**：指定工作順序何時重新執行。 選取下列其中一個選項：  

        - **絕不重新執行已部署的程式**：如果用戶端先前已執行工作順序，就不會重新執行。 即使該工作順序最初是失敗的，或工作順序檔案已經變更，也不會重新執行該工作順序。  

        - **永遠重新執行程式**：已排定部署時，會永遠在用戶端上重新執行工作順序。 即使已經成功執行該工作順序，也會再重新執行。 當您使用週期性部署 (會定期更新工作順序) 時，這個設定會很有用。  

            > [!IMPORTANT]  
            > 預設會選取這個選項。 不過，必須等到您指派必要部署之後，此選項才有作用。 使用者一律可以重新執行可用的部署。  

        - **如果先前嘗試失敗則重新執行**：只有在工作順序先前執行失敗的情況下，才會在已排定部署時重新執行工作順序。 此設定對於必要部署相當有用。 如果上次嘗試執行失敗，就會根據指派排程，自動嘗試重新執行。  

        - **如果先前嘗試時成功則重新執行**：只有當它之前已順利執行用戶端上會重新執行程式。 在您使用週期性部署 (會定期更新工作順序) 時，這個設定十分有用，且每次更新都要求成功安裝先前的更新。  

        > [!NOTE]  
        > 使用者可以重新執行可用的工作順序部署。 在您於生產環境中部署可用的工作順序之前，請先測試如果使用者多次重新執行工作順序，會發生什麼情況。  

7. 在 [使用者經驗]  頁面上，指定下列資訊：  

    - **允許使用者不論指派均執行程式**：指定使用者是否可以在指派排程之外，執行必要的部署。 針對可用的部署，一律會啟用此選項。  

    - **顯示工作順序進度**：指定 Configuration Manager 用戶端是否顯示工作順序進度。  

    - **軟體安裝**：指定是否允許使用者在排程時間後，於設定的維護期間之外安裝軟體。  

    - **系統重新啟動 (如果是完成安裝所需)** ：指定是否允許使用者在指派時間後，在於設定的維護視窗以外的時間安裝軟體之後重新啟動電腦。  

    - **Windows Embedded 裝置的寫入篩選處理**：這項設定會在具備寫入篩選功能的 Windows Embedded 裝置上控制安裝行為。 選擇在安裝期限或維護期間認可變更的選項。 當您選取此選項時，需要重新啟動裝置才能保存裝置的變更。 否則會將應用程式安裝至暫存重疊，並於稍後認可。 當您將工作順序部署到 Windows Embedded 裝置時，請確定該裝置是具有已設定維護期間之集合的成員。  

    - **允許工作順序針對網際網路上的用戶端執行**：指定是否允許工作順序在網際網路型用戶端上執行。 不需要開機媒體的作業 (例如作業系統安裝) 不支援此設定。 此選項僅適用於一般軟體安裝或在標準 OS 內執行作業的指令碼型工作順序。  

        - Windows 10 就地升級工作順序部署到以網際網路為基礎且透過雲端管理閘道的用戶端支援此設定。 如需詳細資訊，請參閱[透過 CMG 部署 Windows 10 就地升級](#deploy-windows-10-in-place-upgrade-via-cmg)。  

8. 在 [警示]  頁面上，指定您想要這項工作順序部署的警示設定。  

9. 在 [發佈點]  頁面上，指定下列資訊：  

    - **部署選項**：指定下列其中一個選項：  

        > [!NOTE]  
        > 使用多點傳送來部署 OS 時，請視需要或在工作順序執行之前，將內容下載到電腦。  

        - **視執行工作順序所需，將內容下載到本機**：指定用戶端根據工作順序的需求，從發佈點下載內容。 用戶端會啟動工作順序。 當工作順序中的步驟需要內容時，會在步驟執行之前，先下載內容。  

        - **啟動工作順序之前下載所有內容到本機**：指定用戶端在執行工作順序前，從發佈點下載所有內容。 如果您在 [部署設定]  頁面上將工作順序設為可供 PXE 和開機媒體部署使用，則不會顯示此選項。  

        - **執行工作順序以視需要直接從發佈點存取內容**：指定用戶端從發佈點執行內容。 只有當您讓所有與工作順序相關的套件能夠使用發佈點上的套件共用時，才會提供此選項。 若要啟用內容使用套件共用，請參閱每個套件上 [內容]  的 [資料存取]  索引標籤。  

            > [!IMPORTANT]  
            > 為了最好的安全性，請選取 [視執行工作順序所需，將內容下載到本機]  或 [啟動工作順序之前下載所有內容到本機]  選項。 當您選取這些選項的任一個時，Configuration Manager 會計算套件的雜湊，這樣就能確保套件完整性。 當您選取 [執行工作順序以視需要直接從發佈點存取內容]  選項時，Configuration Manager 在執行指定程式之前不會驗證套件雜湊。 因為站台無法確保套件完整性，有系統管理權限的使用者可能變更或竄改套件內容。  

    - **當沒有本機發佈點可用時，使用遠端發佈點**：指定用戶端是否可以使用來自鄰近界限群組的發佈點，來下載工作順序所需的內容。  

    - **允許用戶端從預設站台界限群組使用發佈點**：指定當目前或鄰近界限群組中的發佈點無法使用時，用戶端是否應該從站台預設界限群組中的發佈點下載內容。  

        > [!Note]  
        > 自 1810 版開始，當裝置執行工作順序並且需要取得內容時，會使用與 Configuration Manager 用戶端類似的界限群組行為。 如需詳細資訊，請參閱[界限群組的工作順序支援](../../core/servers/deploy/configure/boundary-groups.md#bkmk_bgr-osd)。<!--1359025-->  

10. 若要儲存這些設定以再次使用，請在 [摘要]  索引標籤上選取 [另存為範本]  。 提供範本的名稱，然後選取要儲存的設定。  

11. 完成精靈。  

## <a name="deploy-windows-10-in-place-upgrade-via-cmg"></a>透過 CMG 部署 Windows 10 就地升級

<!-- 1357149 -->
Windows 10 就地升級工作順序現在支援部署到透過[雲端管理閘道](../../core/clients/manage/cmg/plan-cloud-management-gateway.md) (CMG) 管理的網際網路型用戶端。 此功能讓遠端使用者可以更輕鬆地升級到 Windows 10，而不需連線到內部網路。

請確定將就地升級工作順序所參考所有內容都發佈到已啟用內容的 CMG。 (啟用 [CMG 設定](../../core/clients/manage/cmg/setup-cloud-management-gateway.md#settings)：**允許使用 CMG 當作雲端發佈點及處理來自 Azure 儲存體的內容**。)您也可以使用[雲端發佈點](../../core/plan-design/hierarchy/use-a-cloud-based-distribution-point.md)。 否則裝置無法執行工作順序。

當您部署升級工作順序時，請使用下列設定：

- **允許工作順序針對網際網路上的用戶端執行** (位於部署的 [使用者體驗] 索引標籤上)。  

- 在部署的 [發佈點] 索引標籤上，選擇下列其中一個選項：

  - **視執行工作順序所需，將內容下載到本機**。 從 1910 版開始，工作順序引擎就可以從已啟用內容的 CMG 或雲端發佈點下載套件。 此變更為您的 Windows 10 就地升級部署提供額外的彈性，現在支援範圍擴大到以網際網路為基礎的裝置。<!--3601238-->

  - **啟動工作順序之前下載所有內容到本機**。 在 Configuration Manager 1906 版和更早版本中，其他選項 (例如**視執行工作順序所需，將內容下載到本機**) 在此案例中無法運作。 工作順序引擎無法從雲端來源下載內容。 Configuration Manager 用戶端必須先從雲端來源下載內容，才能啟動工作順序。 如有需要，您仍然可以在 1910 版中使用此選項，以符合您的需求。

- (選擇性  ) **預先下載此工作順序的內容** (位於部署的 [一般] 索引標籤上)。 如需詳細資訊，請參閱[設定預先快取內容](configure-precache-content.md)。  

> [!NOTE]
> 從軟體中心開始工作順序。 此案例不支援 Windows PE、PXE 或工作順序媒體。

## <a name="high-risk-deployments"></a><a name="bkmk_high-risk"></a> 高風險部署

當您部署 OS 之類的高風險部署時，[選取集合]  視窗僅會顯示符合該站台內容中所設定之部署驗證設定的自訂集合。 高風險的部署一律限制於自訂集合、您建立的集合，以及內建的 [未知的電腦]  集合。 當您建立高風險的部署時，您無法選取 [所有系統]  這類的內建集合。 若要查看所含用戶端少於設定之大小上限的所有自訂集合，請停用 [隱藏成員計數大於網站大小下限設定的集合]  選項。 如需詳細資訊，請參閱 [Settings to manage high-risk deployments](../../core/servers/manage/settings-to-manage-high-risk-deployments.md) (高風險部署的管理設定)。  

部署驗證設定會以目前的集合成員資格為依據。 在您部署工作順序之後，Configuration Manager 並不會針對高風險部署設定重新評估集合成員資格。  

例如，假設您將 [預設大小]  設為 100，而 [最大值]  設為 1000。 當您建立高風險部署時，[選取集合]  視窗只會顯示所含用戶端低於 100 個的集合。 如果您清除 [隱藏成員計數大於站台大小上限設定的集合]  設定，則此視窗會顯示所含用戶端低於 1000 個的集合。  

當您選取包含站台角色的集合時，會套用下列行為：  

- 如果集合包含站台系統伺服器，且您已將部署驗證設定設定為封鎖包含站台系統伺服器的集合，則會發生錯誤。 您無法繼續建立部署。  

- 如果適用下列其中一個準則，[部署軟體精靈] 就會顯示高風險警告。 若要繼續，您必須同意，才能建立高風險部署。 站台會產生稽核狀態訊息。  

  - 如果集合包含站台系統伺服器，且您已將部署驗證設定設定為警告包含站台系統伺服器的集合  

  - 如果集合超過預設大小值

  - 如果集合包含伺服器  

## <a name="see-also"></a>請參閱

[管理工作順序以自動化工作](manage-task-sequences-to-automate-tasks.md)
