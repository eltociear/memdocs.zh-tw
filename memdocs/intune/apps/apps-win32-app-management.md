---
title: 新增 Win32 應用程式並指派給 Microsoft Intune
titleSuffix: ''
description: 了解如何使用 Microsoft Intune 來新增、指派及管理 Win32 應用程式。 本主題提供 Intune Win32 應用程式傳遞和管理功能的概觀，以及 Win32 應用程式疑難排解資訊。
keywords: ''
author: Erikre
ms.author: erikre
manager: dougeby
ms.date: 04/02/2020
ms.topic: conceptual
ms.service: microsoft-intune
ms.subservice: apps
ms.localizationpriority: high
ms.technology: ''
ms.assetid: efdc196b-38f3-4678-ae16-cdec4303f8d2
ms.reviewer: mghadial
ms.suite: ems
search.appverid: MET150
ms.custom: intune-azure
ms.collection: M365-identity-device-management
ms.openlocfilehash: 8d1933350675a0d36042d1a4bd1e6a26c9a95814
ms.sourcegitcommit: 0e62655fef7afa7b034ac11d5f31a2a48bf758cb
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/29/2020
ms.locfileid: "82254600"
---
# <a name="intune-standalone---win32-app-management"></a>Intune Standalone - Win32 應用程式管理

[Intune 獨立版](../fundamentals/mdm-authority-set.md)現在可提供更強大的 Win32 應用程式管理功能。 雖然雲端連線使用者可以使用設定管理員進行 Win32 應用程式管理，僅使用 Intune 的客戶將可針對其 Win32 企業營運系統 (LOB) 應用程式取得更強大的管理功能。 本主題提供 Intune Win32 應用程式管理功能的概觀及疑難排解資訊。

> [!NOTE]
> 此應用程式管理功能支援 Windows 應用程式使用 32 位元和 64 位元作業系統架構。

> [!IMPORTANT]
> 部署 Win32 應用程式時，請考慮只使用 [Intune 管理延伸模組](../apps/intune-management-extension.md)方法，特別是當您有多檔案型 Win32 應用程式安裝程式時。 若您在 AutoPilot 註冊期間混合 Win32 應用程式與企業營運系統應用程式安裝，應用程式安裝可能會失敗。 在 PowerShell 指令碼或 Win32 應用程式指派至使用者或裝置時，會自動安裝 Intune 管理延伸模組。

## <a name="prerequisites"></a>先決條件

若要使用 Win32 應用程式管理，請務必符合下列準則：

- Windows 10 1607 版或更新版本 (企業、專業與評估版)
- Windows 10 用戶端必須： 
  - 裝置必須加入 Azure AD 並自動註冊。 Intune 管理延伸模組支援加入 Azure AD、加入混合網域，並支援群組原則註冊裝置。 
  > [!NOTE]
  > 針對群組原則註冊案例 - 終端使用者會使用本機使用者帳戶，將其 Windows 10 裝置加入 AAD。 使用者必須使用其 AAD 使用者帳戶登入裝置，並註冊到 Intune。 如果對使用者或裝置指定 PowerShell 指令碼或 Win32 應用程式目標，Intune 會在裝置上安裝 Intune 管理延伸模組。
- Windows 應用程式的大小上限為每個應用程式 8 GB。

## <a name="prepare-the-win32-app-content-for-upload"></a>準備要上傳的 Win32 應用程式內容

使用 [Microsoft Win32 內容準備工具](https://go.microsoft.com/fwlink/?linkid=2065730)來預先處理 Windows 傳統 (Win32) 應用程式。 此工具會將應用程式安裝檔案轉換成 *.intunewin* 格式。 此工具也會偵測一部分的 Intune 必要屬性，來判斷應用程式安裝狀態。 在您於應用程式安裝程式資料夾上使用此工具後，您便可在 Intune 主控台中建立 Win32 應用程式。

> [!IMPORTANT]
> [Microsoft Win32 內容準備工具](https://go.microsoft.com/fwlink/?linkid=2065730)會在建立 *.intunewin* 檔案時壓縮所有的檔案和子資料夾。 請務必將 Microsoft Win32 內容準備工具與安裝程式檔案和資料夾分開保留，才不會在 *.intunewin* 檔案中包含此工具或其他不必要的檔案和資料夾。

您可以從 GitHub 以 ZIP 檔案形式下載 [Microsoft Win32 內容準備工具](https://go.microsoft.com/fwlink/?linkid=2065730)。 此 ZIP 壓縮檔案包含名為 **Microsoft-Win32-Content-Prep-Tool-master** 的資料夾。 此資料夾包含準備工具、授權、讀我檔案和版本資訊。 

### <a name="process-flow-to-create-intunewin-file"></a>建立 .intunewin 檔案的程序流程

   <img alt="Process flow to create a .intunewin file" src="./media/apps-win32-app-management/prepare-win32-app.png" width="700">

### <a name="run-the-microsoft-win32-content-prep-tool"></a>執行 Microsoft Win32 內容準備工具

如果您從命令視窗執行 `IntuneWinAppUtil.exe` 但未提供參數，此工具會引導您逐步輸入必要的參數。 或者，您可以根據下列可用命令列參數，將參數新增至命令。

### <a name="available-command-line-parameters"></a>可用命令列參數 

|    **命令列參數**    |    **描述**    |
|:------------------------------:|:----------------------------------------------------------:|
|    `-h`     |    [說明]    |
|    `-c <setup_folder>`     |    所有安裝程式檔案的資料夾。 此資料夾中的所有檔案都會壓縮成 *.intunewin* 檔案。    |
|    `-s <setup_file>`     |    安裝程式檔案 (例如 *setup.exe* 或 *setup.msi*)。    |
|    `-o <output_folder>`     |    產生 *.intunewin* 檔案的輸出資料夾。    |
|    `-q`       |    安靜模式    |

### <a name="example-commands"></a>範例命令

|    **範例命令**    |    **描述**    |
|:-----------------------------------------------------------------------------------------:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
|    `IntuneWinAppUtil -h`    |    此命令會顯示工具的使用方式資訊。    |
|    `IntuneWinAppUtil -c c:\testapp\v1.0 -s c:\testapp\v1.0\setup.exe -o c:\testappoutput\v1.0 -q`    |    此命令會從指定來源資料夾和安裝程式檔案產生 `.intunewin` 檔案。 針對 MSI 安裝程式檔案，此工具會擷取 Intune 的必要資訊。 若指定 `-q`，則命令會在安靜模式中執行，並且若已存在輸出檔案，則該檔案將會遭到覆寫。 此外，若輸出資料夾不存在，則會自動建立資料夾。    |

當產生 *.intunewin* 檔案時，將您需要參考之任何檔案放到安裝程式資料夾的子資料夾中。 接著，使用相對路徑來參考您需要的特定檔案。 例如：

**安裝程式來源資料夾：** *c:\testapp\v1.0*<br>
**授權檔案：** *c:\testapp\v1.0\licenses\license.txt*

使用相對路徑 *licenses\license.txt* 來參考 *license.txt* 檔案。

## <a name="create-assign-and-monitor-a-win32-app"></a>建立、指派和監視 Win32 應用程式

與企業營運系統 (LOB) 應用程式相似，您可以將 Win32 應用程式新增至 Microsoft Intune。 此類型應用程式通常是在由內部編寫或由協力廠商編寫。 

### <a name="process-flow-to-add-a-win32-app-to-intune"></a>將 Win32 應用程式新增至 Intune 的程序流程

<img alt="Process flow to add a Win32 app to Intune" src="./media/apps-win32-app-management/add-win32-app.svg" width="500">

### <a name="add-a-win32-app-to-intune"></a>將 Win32 應用程式新增至 Intune

下列步驟可提供指導，協助您將 Windows 應用程式新增至 Intune。

1. 登入 [Microsoft Endpoint Manager 系統管理中心](https://go.microsoft.com/fwlink/?linkid=2109431)。
2. 選取 [應用程式]   > [所有應用程式]   > [新增]  。
3. 在 [選取應用程式類型]  窗格中，在 [其他]  應用程式類型底下，選取 [Windows 應用程式 (Win32)]  。

    > [!IMPORTANT]
    > 請務必使用最新版本的 Microsoft Win32 內容準備工具。 如果您未使用最新版本，則會出現警告，指出應用程式是使用舊版 Microsoft Win32 內容準備工具所封裝。 

4. 按一下 [選取]  。 [新增應用程式]  步驟隨即顯示。

## <a name="step-1---app-information"></a>步驟 1 - 應用程式資訊

### <a name="select-the-app-package-file"></a>選取應用程式套件檔案

1. 在 [新增應用程式]  窗格中，按一下 [選取應用程式套件檔案]  。 
2. 在 [應用程式套件檔案]  窗格中，選取 [瀏覽] 按鈕。 然後，選取副檔名為 *.intunewin* 的 Windows 安裝檔案。
   應用程式詳細資料隨即顯示。
3. 當您完成時，請選取 [應用程式套件檔案]  窗格上的 [確定]  。

### <a name="set-app-information"></a>設定應用程式資訊

1. 在 [應用程式資訊]  頁面中，新增應用程式的詳細資料。 窗格中某些值會隨著所選的應用程式自動填入。
    - **名稱**：輸入在公司入口網站中顯示的應用程式名稱。 確定您使用的所有應用程式名稱都是唯一的。 如果有重複的應用程式名稱，只有一個應用程式會出現在公司入口網站中。
    - **描述**：輸入應用程式的描述。 此描述會出現在公司入口網站上。
    - **發行者**：輸入應用程式發行者的名稱。
    - **類別**：選取一或多個內建的應用程式類別，或選取您建立的類別。 類別可以讓使用者在瀏覽公司入口網站時，更輕鬆地找到應用程式。
    - **將此顯示為公司入口網站中的精選應用程式**：當使用者瀏覽應用程式時，在公司入口網站的主頁面上，以突顯的方式顯示應用程式。
    - **資訊 URL**：(選用) 輸入包含此應用程式相關資訊的網站 URL。 此 URL 會出現在公司入口網站上。
    - **隱私權 URL**：(選擇性) 輸入包含這個應用程式之隱私權資訊的網站 URL。 此 URL 會出現在公司入口網站上。
    - **開發人員**：(選擇性) 輸入應用程式開發人員的姓名。
    - **擁有者**：(選擇性) 輸入此應用程式之擁有者的名稱。 **人力資源部門**就是一個例子。
    - **附註**：輸入要與此應用程式建立關聯的任何附註。
    - **標誌**：上傳與應用程式相關聯的圖示。 這是使用者瀏覽公司入口網站時，會隨應用程式一起顯示的圖示。
2. 按一下 [下一步]  以顯示 [程式]  頁面。

## <a name="step-2-program"></a>步驟 2：計畫

1. 在 [程式]  頁面中，設定應用程式的應用程式安裝和移除命令：
    - **安裝命令**：新增完整安裝命令來安裝應用程式。 

        例如，若您的應用程式檔案名稱為 **MyApp123**，請新增下列內容：<br>
        `msiexec /p "MyApp123.msp"`<p>
        若應用程式是 `ApplicationName.exe`，則命令是應用程式名稱，後面接著套件支援的命令引數 (參數)。 <br>
        例如：<br>
        `ApplicationName.exe /quiet`<br>
        在上述命令中，`ApplicationName.exe` 套件支援 `/quiet` 命令引數。<p> 
        如需應用程式套件支援的特定引數，請連絡您的應用程式廠商。

        > [!IMPORTANT]
        > 系統管理員使用命令工具時，必須特別小心。 非預期或會造成損害的命令，可能會透過安裝和卸載命令欄位傳遞。

    - **解除安裝命令**：新增完整解除安裝命令，以根據應用程式的 GUID 來解除安裝應用程式。 

        例如：<br>
        `msiexec /x "{12345A67-89B0-1234-5678-000001000000}"`

    - **安裝行為**：將安裝行為設定為 [系統]  或 [使用者]  。

        > [!NOTE]
        > 您可以設定在 [使用者]  或 [系統]  內容中安裝 Win32 應用程式。 [使用者]  內容是指唯一的指定使用者。 [系統]  內容是指 Windows 10 裝置的所有使用者。
        >
        > 終端使用者不需要登入裝置來安裝 Win32 應用程式。
        > 
        > 將應用程式設定為安裝於使用者內容中，且裝置上的終端使用者具有管理員權限時，(根據預設) 將以管理員權限來執行 Win32 應用程式的安裝和解除安裝。
    
    - **裝置重新啟動行為**：選取下列其中一個選項：
        - **根據傳回碼決定行為**：選擇此選項來根據傳回碼重新啟動裝置。
        - **無特定動作**：選擇此選項來在安裝以 MSI 為基礎的應用程式時隱藏裝置重新啟動。
        - **應用程式安裝可能會強制裝置重新啟動**：選擇此選項來允許應用程式安裝在不隱藏重新啟動的情況下完成。
        - **Intune 用戶端將會強制裝置重新啟動**：選擇此選項來在成功安裝應用程式之後一律重新啟動裝置。

    - **指定傳回碼以指出安裝後行為**：新增用來指定應用程式安裝重試行為或安裝後行為的傳回碼。 根據預設，傳回碼項目會在應用程式建立時新增。 但是，您可以新增額外的傳回碼或變更現有傳回碼。
        1. 在 [代碼類型]  欄中，將 [代碼類型]  設定為下列其中一個項目：
            - **失敗** – 傳回值，表示應用程式安裝失敗。
            - **強制重新開機** – 強制重新開機傳回碼不允許下一個 Win32 應用程式在用戶端重新開機前進行安裝。 
            - **軟開機** – 軟開機傳回代碼允許下一個 Win32 應用程式在用戶端無須重新開機的情況下進行安裝。 重新開機之後才能完成安裝目前的應用程式。
            - **重試** – 重試傳回代碼代理程式會嘗試安裝應用程式三次。 它會在每一次的嘗試之間等待 5 分鐘。 
            - **成功** – 傳回值，表示應用程式安裝成功。
        2. 若有需要，請按一下 [新增]  以新增額外傳回碼，或是修改現有傳回碼。
2. 按一下 [下一步]  以顯示 [需求]  頁面。        

## <a name="step-3-requirements"></a>步驟 3：需求

1. 在 [需求]  頁面中，指定裝置必須符合才能安裝應用程式的需求：
    - **作業系統架構**：選擇安裝應用程式所需要的架構。
    - **最低作業系統**：選取安裝應用程式所需要的最低作業系統。
    - **必要磁碟空間 (MB)** ：(選擇性) 新增安裝應用程式時，系統磁碟上所需要的可用磁碟空間。
    - **必要實體記憶體 (MB)** ：(選擇性) 新增安裝應用程式所需要的實體記憶體 (RAM)。
    - **必要最低邏輯處理器數**：(選擇性) 新增安裝應用程式所需要的最低邏輯處理器數目。
    - **必要最低 CPU 速度 (MHz)** ：(選擇性) 新增安裝應用程式所需要的最低 CPU 速度。
    - **設定其他需求規則**： 
        1. 按一下 [新增]  以顯示 [新增需求規則]  窗格，並設定其他需求規則。 選取 [需求類型]  以選擇您要用於決定如何驗證需求的規則類型。 需求規則可能會以檔案系統資訊、登錄值或 PowerShell 指令碼為基礎。 
            - **檔案**：當您選擇 [檔案]  作為 [需求類型]  時，需求規則必須偵測檔案或資料夾、日期、版本或大小。 
                - **路徑**  – 包含要偵測檔案或資料夾的資料夾完整路徑。
                - **檔案或資料夾** – 要偵測的檔案或資料夾。
                - **屬性** - 選取用於驗證應用程式是否存在的規則類型。
                - **在 64 位元用戶端上與 32 位元應用程式建立關聯** – 選取 [是]  來在 64 位元用戶端上展開 32 位元內容裡的任何路徑環境變數。 選取 [否]  來在 64 位元用戶端上展開 64 位元內容裡的任何路徑變數 (預設值)。 32 位元用戶端一律會使用 32 位元內容。
            - **登錄**：當您選擇 [登錄]  作為 [需求類型]  時，需求規則必須偵測以值、字串、整數或版本為基礎的登錄設定。
                - **機碼路徑** – 包含要偵測值的登錄項目完整路徑。
                - [Value name]**值名稱** – 要偵測的登錄值名稱。 若此值空白，則會對機碼進行偵測。 若偵測方法是檔案或資料夾存在性以外的方法，則會使用機碼的 (預設) 值。
                - **登錄機碼需求** - 選取用於決定如何驗證需求規則的登錄機碼比較類型。
                - **在 64 位元用戶端上與 32 位元應用程式建立關聯** - 選取 [是]  來在 64 位元用戶端上搜尋 32 位元登錄。 選取 [否]  來在 64 位元用戶端上搜尋 64 位元登錄 (預設值)。 32 位元用戶端一律會搜尋 32 位元登錄。
            - **指令碼**：當您無法在 Intune 主控台中建立以檔案、登錄或提供給您之任何其他方法為基礎的需求規則時，請選擇 [指令碼]  作為 [需求類型]  。
                - **指令檔** - 針對以 PowerShell 指令碼為基礎的需求規則，如果結束代碼為 0，我們將會偵測到更詳細的 STDOUT。 例如，我們可能會偵測到 STDOUT 以值 1 的整數表示。
                - **在 64 位元用戶端上作為 32 位元處理序執行** - 選取 [是]  以在 64 位元用戶端上的 32 位元處理序中執行指令碼。 選取 [否]  \(預設\) 以在 64 位元用戶端上的 64 位元處理序中執行指令碼。 32 位元用戶端會在 32 位元處理序中執行指令碼。
                - **使用登入認證執行此指令碼**：選取 [是]  以使用登入的裝置認證來執行指令碼**。
                - [Enforce script signature check]**強制指令碼簽章檢查** – 選取 [是]  來驗證指令碼是否是由信任的發佈者簽署，允許指令碼在不顯示警告或提示的情況下執行指令碼。 指令碼會在解除封鎖的情況下執行。 選取 [否]  來在不進行簽章驗證的情況下，透過終端使用者確認來執行指令碼 (預設值)。
                - **選取輸出資料類型**：選取用於判斷需求規則是否相符的資料類型。
        2. 在您設定好需求規則之後，請選取 [確定]  。
2. 按一下 [下一步]  以顯示 [偵測規則]  頁面。   

## <a name="step-4-detection-rules"></a>步驟 4：偵測規則

1. 在 [偵測規則]  頁面中，設定偵測應用程式是否存在的規則：
    
    **規則格式**：選取偵測應用程式是否存在的方式。 您可以選擇手動設定偵測規則，或是使用自訂指令碼來偵測應用程式是否存在。 您至少必須選擇一個偵測規則。 

    > [!NOTE]
    > 在 [偵測規則]  窗格中，您可以選擇新增多個規則。 必須符合**所有**規則的條件，才能偵測應用程式。
    >
    > 如果 Intune 偵測到應用程式不存在於裝置上，Intune 將會在 24 小時後再次提供該應用程式。 只有以必要意圖為目標的應用程式，才會發生這種情況。

    - **手動設定偵測規則** – 您可以選取下列其中一個規則類型：
        1. **MSI** – 根據 MSI 版本檢查進行驗證。 此選項只能新增一次。 當您選擇此規則類型時，您有兩個設定：
            - **MSI 產品代碼**  – 新增應用程式的有效 MSI 產品代碼。
            - **MSI 產品版本檢查** – 選取 [是]  來在驗證 MSI 產品代碼的同時驗證 MSI 產品版本。
        2. **檔案** – 根據檔案或資料夾偵測、日期、版本或大小進行驗證。
            - **路徑**  – 包含要偵測檔案或資料夾的資料夾完整路徑。
            - **檔案或資料夾** – 要偵測的檔案或資料夾。
            - **偵測方法** – 選取要用於驗證應用程式是否存在的偵測方法類型。
            - **在 64 位元用戶端上與 32 位元應用程式建立關聯** – 選取 [是]  來在 64 位元用戶端上展開 32 位元內容裡的任何路徑環境變數。 選取 [否]  來在 64 位元用戶端上展開 64 位元內容裡的任何路徑變數 (預設值)。 32 位元用戶端一律會使用 32 位元內容。
            
            **檔案型偵測範例**
            1. 檢查檔案是否存在。
         
                ![偵測規則窗格的螢幕擷取畫面 - 檔案存在](./media/apps-win32-app-management/apps-win32-app-03.png)
        
            2. 檢查資料夾是否存在。
         
                ![偵測規則窗格的螢幕擷取畫面 - 資料夾存在](./media/apps-win32-app-management/apps-win32-app-04.png)
        
        3. **登錄** – 根據值、字串、整數或版本進行驗證。
            - **機碼路徑** – 包含要偵測值的登錄項目完整路徑。
            - [Value name]**值名稱** – 要偵測的登錄值名稱。 若此值空白，則會對機碼進行偵測。 若偵測方法是檔案或資料夾存在性以外的方法，則會使用機碼的 (預設) 值。
            - **偵測方法** – 選取要用於驗證應用程式是否存在的偵測方法類型。
            - **在 64 位元用戶端上與 32 位元應用程式建立關聯** - 選取 [是]  來在 64 位元用戶端上搜尋 32 位元登錄。 選取 [否]  來在 64 位元用戶端上搜尋 64 位元登錄 (預設值)。 32 位元用戶端一律會搜尋 32 位元登錄。
            
            **登錄型偵測範例**
            1. 檢查登錄機碼是否存在。
            
                ![偵測規則窗格的螢幕擷取畫面 - 登錄機碼存在](./media/apps-win32-app-management/apps-win32-app-05.png)    
            
            2. 檢查登錄值是否存在。
        
                ![偵測規則窗格的螢幕擷取畫面 - 登錄值存在](./media/apps-win32-app-management/apps-win32-app-06.png)    
        
            3. 檢查登錄值字串是否相等。
        
                ![偵測規則窗格的螢幕擷取畫面 - 登錄字串相等](./media/apps-win32-app-management/apps-win32-app-07.png)    
     
    - **使用自訂偵測指令碼** – 指定要用於偵測應用程式的 PowerShell 指令碼。 
    
       1. **指令碼檔案** – 選取將偵測用戶端上是否存在應用程式的 PowerShell 指令碼。 當指令碼傳回 0 值結束代碼，並將字串值寫入 STDOUT 時，便會偵測到應用程式。

       2. **在 64 位元用戶端上作為 32 位元處理序執行** - 選取 [是]  以在 64 位元用戶端上的 32 位元處理序中執行指令碼。 選取 [否]  \(預設\) 以在 64 位元用戶端上的 64 位元處理序中執行指令碼。 32 位元用戶端會在 32 位元處理序中執行指令碼。

       3. [Enforce script signature check]**強制指令碼簽章檢查** – 選取 [是]  來驗證指令碼是否是由信任的發佈者簽署，允許指令碼在不顯示警告或提示的情況下執行指令碼。 指令碼會在解除封鎖的情況下執行。 選取 [否]  來在不進行簽章驗證的情況下，透過終端使用者確認來執行指令碼 (預設值)。
    
            Intune 代理程式會檢查指令碼的結果。 它會讀取指令碼寫入到標準輸出 (STDOUT) 串流、標準錯誤 (STDERR) 串流及結束代碼的值。 如果指令碼以非零值結束，代表指令碼執行失敗，且應用程式偵測狀態為未安裝。 如果結束代碼為零而 STDOUT 含有資料，表示應用程式偵測狀態是「已安裝」。 

            > [!NOTE]
            > Microsoft 建議將您的指令碼編碼為 UTF-8。 當指令碼以 0 值結束時，指令碼執行便已成功。 第二個輸出通道表示已偵測到應用程式 - STDOUT 指出已在用戶端上找到應用程式。 我們並非要在 STDOUT 中尋找特定字串。

2. 在您新增規則之後，請選取 [下一步]  以顯示 [相依性]  頁面。

## <a name="step-5-dependencies"></a>步驟 5：相依性

應用程式相依性是必須先安裝才能安裝 Win32 應用程式的應用程式。 您可以要求將其他應用程式安裝為相依性。 具體來說，裝置必須安裝相依的應用程式，才能安裝 Win32 應用程式。 最多可以有 100 個相依性，其中包括任何內含相依性的相依性，以及應用程式本身。 只有在將 Win32 應用程式新增並上傳至 Intune 之後，才能新增 Win32 應用程式相依性。 一旦新增您的 Win32 應用程式之後，您會在 Win32 應用程式的窗格上看到 [相依性]  選項。 

任何 Win32 應用程式相依性都必須也是 Win32 應用程式。 它不支援不同的應用程式類型，例如單一 MSI LOB 應用程式或市集應用程式。

新增應用程式相依性時，您可以根據應用程式名稱和發行者進行搜尋。 此外，您可以根據應用程式名稱和發行者來排序新增的相依性。 無法在所新增應用程式相依性清單中選取先前新增的應用程式相依性。 

您可以選擇是否要自動安裝每個相依的應用程式。 根據預設，每個相依性的 [自動安裝]  選項會設定為 [是]  。 藉由自動安裝相依的應用程式，即使未對使用者或裝置指定相依的應用程式目標，Intune 也會在裝置上安裝應用程式來滿足相依性，再安裝您的 Win32 應用程式。 請注意，相依性可以有遞迴子相依性，在安裝主要相依性之前會先安裝每個子相依性。 此外，相依性安裝不會遵循指定相依性層級的安裝順序。

### <a name="select-the-dependencies"></a>選取相依性

在 [相依性]  頁面中，選取必須先安裝才能安裝 Win32 應用程式的應用程式：
1. 按一下 [新增]  以顯示 [新增相依性]  窗格。
3. 一旦您新增相依的應用程式之後，按一下 [選取]  。
4. 在 [自動安裝]  欄底下選取 [是]  或 [否]  ，以選擇是否要自動安裝相依的應用程式。
5. 按一下 [下一步]  以顯示 [範圍標籤]  頁面。

### <a name="understand-additional-dependency-details"></a>了解其他相依性詳細資料

終端使用者會看到 Windows 快顯通知，指出相依的應用程式即將下載並在 Win32 應用程式安裝過程中進行安裝。 此外，若未安裝相依的應用程式，終端使用者通常會看到下列其中一個通知：
- 一或多個相依的應用程式無法安裝
- 未符合一或多個相依應用程式的需求
- 一或多個相依的應用程式仍在等待重新啟動裝置

如果您選擇不要**自動安裝**相依性，則不會嘗試安裝 Win32 應用程式。 此外，應用程式報告會顯示相依性已標示為 `failed`，並同時提供失敗原因。 您可以按一下 Win 32 應用程式[安裝詳細資料](troubleshoot-app-install.md#win32-app-installation-troubleshooting)中所提供的失敗 (或警告)，來檢視相依性安裝失敗。

每個相依性會遵守 Intune Win32 應用程式重試邏輯 (等候 5 分鐘後嘗試安裝 3 次)，以及全域重新評估排程。 此外，相依性僅適用於在裝置上安裝 Win32 應用程式時。 相依性不適用於解除安裝 Win32 應用程式。 若要刪除相依性，您必須在相依性清單資料列結尾的相依應用程式左側，按一下省略符號 (三個點)。 

## <a name="step-6---select-scope-tags-optional"></a>步驟 6 - 選取範圍標籤 (選擇性)
您可以使用範圍標籤來決定可在 Intune 中看見用戶端應用程式資訊的人員。 如需範圍標籤的完整詳細資料，請參閱[針對分散式 IT 使用角色型存取控制和範圍標籤](../fundamentals/scope-tags.md)。

1. 按一下 [選取範圍標籤]  以選擇性地為應用程式新增範圍標籤。 
2. 按一下 [下一步]  以顯示 [指派]  頁面。

## <a name="step-7---assignments"></a>步驟 7 - 指派

您可以為應用程式選取 [必要]  、[適用於已註冊的裝置]  ，或 [解除安裝]  群組指派。 如需詳細資訊，請參閱[新增群組來組織使用者和裝置](../fundamentals/groups-add.md)和[使用 Microsoft Intune 將應用程式指派給群組](apps-deploy.md)。

1. 針對特定的應用程式，請選取指派類型：
    - **必要**：此應用程式會安裝在所選群組中的裝置上。
    - **適用於已註冊的裝置**：使用者從公司入口網站應用程式或公司入口網站中安裝應用程式。
    - **解除安裝**：此應用程式會從所選群組中的裝置上解除安裝。
2. 按一下 [新增群組]  並指派將使用此應用程式的群組。
3. 在 [選取群組]  窗格中，選取以根據使用者或裝置進行指派。
4. 在您選取群組之後，您也可以設定 [終端使用者通知]  、[可用性]  及 [安裝期限]  。 如需詳細資訊，請參閱[設定 Win32 應用程式可用性和通知](apps-win32-app-management.md#set-win32-app-availability-and-notifications)。
5. 如果您想要將任何使用者群組排除，使其不受此應用程式指派影響，請選取 [模式]  欄底下的 [已包含]  。 [編輯指派]  窗格隨即顯示。 您可以將 [模式]  從 [已包含]  設定為 [已排除]  。 按一下 [確定]  以關閉 [編輯指派]  窗格。
6. 在 [應用程式設定]  區段中，選取應用程式的 [傳遞最佳化優先順序]  。 此設定會決定應用程式內容的下載方式。 您可以根據指派來選擇要以背景模式或前景模式下載應用程式內容。 
7. 在您完成應用程式指派的設定之後，請按一下 [下一步]  以顯示 [檢閱 + 建立]  頁面。

## <a name="step-8---review--create"></a>步驟 8 - 檢閱 + 建立

1. 檢閱您針對應用程式所輸入的值和設定。 確認您所設定的應用程式資訊正確無誤。
2. 當您完成時，請按一下 [建立]  以將應用程式新增到 Intune。

    企業營運應用程式的 [概觀]  刀鋒視窗隨即顯示。

此時，您已完成將 Win32 應用程式新增至 Intune 的步驟。 如需應用程式指派和監視的資訊，請參閱[使用 Microsoft Intune 指派應用程式給群組](apps-deploy.md)和[使用 Microsoft Intune 監視應用程式資訊和指派](apps-monitor.md)。

## <a name="delivery-optimization"></a>傳遞最佳化

Windows 10 1709 與更新版本的用戶端將會使用 Windows 10 用戶端上的傳遞最佳化元件來下載 Intune Win32 應用程式內容。 傳遞最佳化提供預設開啟的同儕節點對同儕節點功能。 您可以設定傳遞最佳化代理程式，以根據指派在背景或前景模式下載 Win32 應用程式內容。 傳遞最佳化可以由群組原則及透過 Intune 裝置設定進行設定。 如需詳細資訊，請參閱[適用於 Windows 10 的傳遞最佳化](https://docs.microsoft.com/windows/deployment/update/waas-delivery-optimization) \(部分機器翻譯\)。 

> [!NOTE]
> 您也可以在 Configuration Manager 發佈點上安裝 Microsoft 已連線快取伺服器，來快取 Intune Win32 應用程式內容。 如需詳細資訊，請參閱 [Configuration Manager 中的 Microsoft 連線快取 - Intune Win32 應用程式的支援](https://docs.microsoft.com/configmgr/core/plan-design/hierarchy/microsoft-connected-cache#bkmk_intune)。

## <a name="install-required-and-available-apps-on-devices"></a>在裝置上安裝必要和可用應用程式

終端使用者會看到必要及可用應用程式安裝的 Windows 快顯通知。 下列影像顯示快顯通知範例，其中表示裝置必須重新啟動，才能完成應用程式安裝。 

![應用程式安裝 Windows 快顯通知的螢幕擷取畫面](./media/apps-win32-app-management/apps-win32-app-08.png)    

下列影像會通知終端使用者即將將應用程式變更套用到裝置。

![通知使用者已進行應用程式變更的螢幕擷取畫面](./media/apps-win32-app-management/apps-win32-app-09.png)    

此外，公司入口網站應用程式會向終端使用者顯示額外的應用程式安裝狀態訊息。 下列條件適用於 Win32 相依性功能：
- 應用程式無法啟動。 不符合系統管理員定義的相依性。
- 已成功安裝應用程式，但需要重新啟動。
- 應用程式正在安裝，但需要重新啟動才能繼續。

## <a name="set-win32-app-availability-and-notifications"></a>設定 Win32 應用程式可用性和通知
您可以設定 Win32 應用程式的開始時間和期限時間。 在開始時間時，Intune 管理擴充功能將會開始下載應用程內容，並針對所需意圖對它進行快取。 系統會在期限時間安裝應用程式。 針對可用的應用程式，開始時間將會決定何時會在公司入口網站中顯示應用程式，而且系統將會在使用者從公司入口網站要求該應用程式時下載內容。 此外，您可以啟用重新啟動寬限期。 

> [!IMPORTANT]
> 只有當 [程式]  區段的 [裝置重新啟動行為]  設定為下列其中一個選項時，才能使用 [指派]  區段中的 [重新啟動寬限期]  設定：
> - [根據傳回碼決定行為] 
> - [Intune 用戶端將會強制裝置重新啟動] 

使用下列步驟來針對所需應用程式設定以日期和時間為基礎的應用程式可用性：

1. 登入 [Microsoft Endpoint Manager 系統管理中心](https://go.microsoft.com/fwlink/?linkid=2109431)。
2. 選取 [應用程式]   > [所有應用程式]  。
3. 從清單中選取現有的 [Windows 應用程式 (Win32)]  。 
4. 從應用程式窗格，選取 [屬性]   > [指派]  區段旁邊的 [編輯]  > [需要]  指派類型底下的 [新增群組]  。 
   請注意，應用程式可用性可以根據指派類型設定。 [指派類型]  可以是 [必要]  、[適用於已註冊的裝置]  ，或 [解除安裝]  。
5. 在 [選取群組]  窗格中選取群組，以指定要將應用程式指派給哪些使用者群組。 

    > [!NOTE]
    > [指派類型]  選項包含下列項目：<br>
    > - **必要**：您可以選擇 [要求所有使用者都安裝此應用程式]  和/或 [要求所有裝置都安裝此應用程式]  。<br>
    > - **適用於已註冊的裝置**：您可以選擇 [讓所有已註冊裝置的使用者都可以使用此應用程式]  。<br>
    > - **解除安裝**：您可以選擇 [為所有使用者將此應用程式解除安裝]  和/或 [為所有裝置將此應用程式解除安裝]  。

6. 若要修改 [終端使用者通知]  選項，請選取 [顯示所有快顯通知]  。
7. 在 [編輯指派]  窗格中，將 [使用者通知]  設定為 [顯示所有快顯通知]  。 請注意，您可以將 [使用者通知]  設定為 [顯示所有快顯通知]  、[顯示電腦重新開機的快顯通知]  ，或是 [隱藏所有快顯通知]  。
8. 將 [應用程式可用性]  設定為 [特定日期與時間]  ，然後選取您的日期與時間。 此日期與時間會指定將應用程式下載到使用者裝置上的時機。 
9. 將 [應用程式安裝期限]  設定為 [特定日期與時間]  ，然後選取您的日期與時間。 此日期與時間會指定將應用程式安裝到使用者裝置上的時機。 針對相同的使用者或裝置進行多個指派時，系統會根據最早的可能時間來挑選應用程式安裝期限的時間。

10. 按一下 [重新啟動寬限期]  旁邊的 [已啟用]  。 重新啟動寬限期會在裝置上的應用程式安裝完成後立即開始。 停用時，裝置可以在不發出警告的情況下重新啟動。 <br>您可以自訂下列選項：
    - **裝置重新啟動寬限期 (分鐘)** ：預設值為 1440 分鐘 (24 小時)。 此值的最大值為 2 週。
    - **選取要再重新啟動前，顯示重新啟動倒數對話方塊的時間 (分鐘)** ：預設值為 15 分鐘。
    - **允許使用者延遲重新啟動通知**：您可以選擇 [是]  或 [否]  。
        - **選取延遲持續時間 (分鐘)** ：預設值為 240 分鐘 (4 小時)。 延遲值不可以超過重新啟動寬限期。

11. 按一下 [檢閱並儲存]  。

## <a name="toast-notifications-for-win32-apps"></a>Win32 應用程式的快顯通知 
如有需要，您可以隱藏而不顯示每個應用程式指派的終端使用者快顯通知。 從 Intune 選取 [應用程式]   > [所有應用程式]  > 選取應用程式 > [指派]   > [包含群組]  。 

> [!NOTE]
> Intune 管理延伸模組所安裝的 Win32 應用程式不會在未註冊裝置上解除安裝。 系統管理員可以利用指派排除，來確保不會對 BYOD 裝置提供 Win32 應用程式。

## <a name="troubleshoot-win32-app-issues"></a>針對 Win32 應用程式問題進行疑難排解
用戶端電腦上的代理程式記錄通常位於 `C:\ProgramData\Microsoft\IntuneManagementExtension\Logs`。 您可以利用 `CMTrace.exe` 檢視這些記錄檔。 如需詳細資訊，請參閱 [CMTrace](https://docs.microsoft.com/configmgr/core/support/cmtrace)。

![用戶端機器上代理程式記錄檔的螢幕擷取畫面](./media/apps-win32-app-management/apps-win32-app-10.png)    

> [!IMPORTANT]
> 為了允許正確安裝並執行 LOB Win32 應用程式，反惡意程式碼設定應該排除下列目錄不要進行掃描：<p>
> **在 X64 用戶端電腦上**：<br>
> *C:\Program Files (x86)\Microsoft Intune Management Extension\Content*<br>
> *C:\windows\IMECache*
>  
> **在 X86 用戶端電腦上**：<br>
> *C:\Program Files\Microsoft Intune Management Extension\Content*<br>
> *C:\windows\IMECache*
>
> 如需詳細資訊，請參閱[執行目前支援之 Windows 版本的企業電腦的病毒掃描建議](https://support.microsoft.com/help/822158/virus-scanning-recommendations-for-enterprise-computers)。

### <a name="detecting-the-win32-app-file-version-using-powershell"></a>使用 PowerShell 偵測 Win32 應用程式的檔案版本

如果偵測 Win32 應用程式檔案版本發生困難，請考慮使用或修改下列 PowerShell 命令：

``` PowerShell

$FileVersion = [System.Diagnostics.FileVersionInfo]::GetVersionInfo("<path to binary file>").FileVersion
#The below line trims the spaces before and after the version name
$FileVersion = $FileVersion.Trim();
if ("<file version of successfully detected file>" -eq $FileVersion)
{
#Write the version to STDOUT by default
$FileVersion
exit 0
}
else
{
#Exit with non-zero failure code
exit 1
}
```

在上述的 PowerShell 命令中，以您的 Win32 應用程式檔案路徑取代 `<path to binary file>` 字串。 範例路徑會類似下列：<br>
`C:\Program Files (x86)\Microsoft SQL Server Management Studio 18\Common7\IDE\ssms.exe`

此外，以您要偵測的檔案版本取代 `<file version of successfully detected file>` 字串。 範例檔案版本字串會類似下列：<br>
`2019.0150.18118.00 ((SSMS_Rel).190420-0019)`

如果您需要取得 Win32 應用程式的版本資訊，您可以使用下列 PowerShell 命令：

``` PowerShell

[System.Diagnostics.FileVersionInfo]::GetVersionInfo("<path to binary file>").FileVersion

```

在上述的 PowerShell 命令中，以您的檔案路徑取代 `<path to binary file>`。

### <a name="additional-troubleshooting-areas-to-consider"></a>其他應考慮的疑難排解區域
- 檢查目標，確認代理程式已安裝在裝置上 - 目標為群組的 Win32 應用程式，或是目標為群組的 PowerShell 指令碼會建立安全性群組的代理程式安裝原則。
- 檢查 OS 版本 – Windows 10 1607 或更新版本。  
- 檢查 Windows 10 SKU - Windows 10 S 或在啟用 S 模式的情況下執行的 Windows 版本不支援 MSI 安裝。

如需針對 Win32 應用程式進行疑難排解的詳細資訊，請參閱[針對 Win32 應用程式安裝進行疑難排解](troubleshoot-app-install.md#win32-app-installation-troubleshooting)。

## <a name="next-steps"></a>後續步驟

- 如需將應用程式新增至 Intune 的詳細資訊，請參閱[將應用程式新增至 Microsoft Intune](apps-add.md)。
