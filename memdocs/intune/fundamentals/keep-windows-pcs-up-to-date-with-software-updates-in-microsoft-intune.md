---
title: Windows 電腦的軟體更新
titleSuffix: Microsoft Intune
description: Intune 會確保盡快安裝最新的修補程式和軟體更新，協助您將受控的電腦保持在最新狀態。
keywords: ''
author: dougeby
ms.author: dougeby
manager: dougeby
ms.date: 01/01/2018
ms.topic: archived
ms.service: microsoft-intune
ms.subservice: fundamentals
ms.localizationpriority: medium
ms.assetid: 48e9c41a-d2de-424e-9610-cfd1ad514210
ms.reviewer: owenyen
ms.suite: ems
search.appverid: MET150
ms.custom: intune-classic-keep
ms.collection: M365-identity-device-management
ms.openlocfilehash: 9a1a5b291135f5c6d42a47377d14d6d3d4f13411
ms.sourcegitcommit: 7f17d6eb9dd41b031a6af4148863d2ffc4f49551
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/21/2020
ms.locfileid: "79362325"
---
# <a name="keep-windows-pcs-up-to-date-with-software-updates-in-microsoft-intune"></a>利用 Microsoft Intune 讓 Windows 電腦的軟體更新保持在最新狀態

[!INCLUDE [classic-portal](../includes/classic-portal.md)]

> [!NOTE]
> 本主題中的資訊僅適用於使用 Intune 軟體用戶端作為電腦所管理的 Windows 桌上型電腦。 如果想要管理註冊為行動裝置其 Windows 電腦的更新，請參閱[在 Intune 中管理軟體更新](../protect/windows-update-for-business-configure.md)。

Microsoft Intune 可協助您使用一些方式來保護受控的電腦，包括管理軟體更新，透過確保快速安裝最新修補程式和軟體更新，讓電腦維持最新狀態。

如果您尚未在電腦上安裝 Intune 用戶端，請參閱[使用 Microsoft Intune 安裝 Windows 電腦用戶端](install-the-windows-pc-client-with-microsoft-intune.md)。

當 Microsoft Update 提供新的更新，或您已建立協力廠商更新，且這些更新適用於您的受管理電腦時，[更新] 工作區的 [概觀] 頁面上會顯示通知。 選擇此通知連結後，您接著就可以執行各種作業，例如檢視更新的詳細資訊、核准或拒絕更新，以及檢視通過核准將安裝更新的電腦。

> [!IMPORTANT]
> 除非已安裝用戶端，並且成功管理至少一個電腦用戶端，否則 [更新]  工作區不會顯示在系統管理員主控台中。

核准並安裝更新時，您可以在 Intune 主控台的 [更新]  工作區中檢查安裝成功或失敗。

下列章節將協助您讓受控之電腦上的軟體保持在最新狀態。

## <a name="before-you-start"></a>在您開始使用 Intune 之前
開始建立和核准軟體更新之前，請設定並部署原則到電腦上，控制安裝更新的時機和方式。

### <a name="to-configure-update-policy-settings"></a>若要設定更新原則設定

1. 在 [Microsoft Intune 管理主控台](https://manage.microsoft.com/)中，選擇 [原則]  &gt; [概觀]  &gt; [新增原則]  。

2. 針對更新設定來設定和部署 **Microsoft Intune 代理程式設定** 原則。 您可以使用建議的設定或自訂設定。 如需如何建立和部署原則的詳細資訊，請參閱[使用 Microsoft Intune 電腦用戶端的一般 Windows 電腦管理工作](common-windows-pc-management-tasks-with-the-microsoft-intune-computer-client.md)。

下表顯示可在原則中設定的值，以及在不自訂原則情況下將使用的建議值。 您可以在 [更新]  區段中找到這些設定。

  |原則設定|詳細資料|
    |------------------|--------------------|
    |**更新和應用程式偵測頻率 (小時)** |指定 Intune 檢查是否有新的更新與新的應用程式的頻率 (8 到 22 小時)。<br /><br />建議值： **8** 小時。|
    |**自動或提示安裝更新和應用程式** |指定自動安裝更新或在安裝之前提示使用者。 此外，這項設定還可讓您排定安裝更新和應用程式的時間。<br /><br />[按照排程自動安裝更新和應用程式]  會使用指定的排程安裝更新和應用程式。<br /><br />做為相依原則設定的 [針對 Windows 電腦使用自動維護]   則指定在 Windows 自動維護期間安裝更新和應用程式。<br /><br />[提示使用者安裝]  會在更新已就緒時提示使用者進行安裝。<br /><br />建議值：<br /><br />選取 [按照排程自動安裝更新和應用程式] <br /><br />**排定的日期：每天**<br /><br />**排定的時間：上午 3:00**<br /><br />選取 [針對 Windows 電腦使用自動維護] |
    |**允許立即安裝不會中斷 Windows 的更新** |[允許]  會在下載更新後立即安裝，但會中斷或重新啟動 Windows 的更新除外。 這些更新會依據 [自動或提示安裝更新]  的設定來安裝更新。<br /><br />[不允許]  會依據 [自動或提示安裝更新]  的設定來安裝更新。<br /><br />建議值： **Allow** |
    |**安裝排程更新和應用程式後到重新啟動 Windows 的延遲時間 (分鐘)** |指定在安裝排程更新和應用程式後需等候多久才能重新啟動 Windows 的時間 (1 到 30 分鐘)。<br /><br />建議值： **15 分鐘** |
    |**Windows 重新啟動後開始安裝錯過排程更新和應用程式的延遲時間 (分鐘)** |指定當錯過排程更新時，Windows 重新啟動之後需等候多久才能開始安裝更新和應用程式 (1 到 60 分鐘)。<br /><br />建議值： **5 分鐘**|
    |**允許登入的使用者控制排程更新和應用程式安裝後的 Windows 重新啟動作業** |指定登入的使用者是否可以延遲重新啟動 (如果設定為 [是]  )，或是收到 Windows 自動重新啟動的通知 (如果設定為 [否]  )。 如果在更新和應用程式的排程安裝完成時，沒有任何使用者登入，Windows 便會視需要自動重新啟動。 設定為 [否]  時，Windows 重新啟動前的時間預設為 5 分鐘。<br /><br />建議值： **是**|
    |**在 Intune 用戶端代理程式強制更新期間提示使用者重新啟動 Windows** |指定當 Intune 用戶端強制更新需要重新啟動 Windows 時，是否要提示登入的使用者重新啟動 Windows。<br /><br />建議值： **是**|
    |**Microsoft Intune 用戶端代理程式強制更新安裝排程** |排程安裝用戶端更新的時間。<br /><br />建議值：尚未設定|
    |**排程更新和應用程式安裝後重新啟動 Windows 提示間隔的延遲時間 (分鐘)** |指定當安裝需要重新啟動 Windows 的排程更新或應用程式，而使用者延遲重新啟動時，提示使用者重新啟動 Windows 的頻率 (1 到 1440 分鐘)。<br /><br />建議值： **30 分鐘** |

## <a name="update-software-made-by-microsoft"></a>更新 Microsoft 開發的軟體
更新 Microsoft 軟體幾乎是全自動的。 不過，在開始之前，您應先設定下列兩項：

- [產品類別和更新分類]  – 定義您想提供給電腦之更新的類別和分類。 例如，您可能決定只要安裝 Microsoft Office 的重大更新。

- [自動核准規則]  – 這些規則會自動核准指定類型的更新，減輕系統管理負擔。 例如，您可以自動核准所有重大軟體更新。

請使用下列兩項程序協助您準備開始使用軟體更新：

### <a name="configure-the-product-categories-and-update-classifications-you-want-to-make-available-to-managed-computers"></a>設定您要提供給受管理電腦的產品類別和更新分類

1. 在 [Microsoft Intune 管理主控台](https://manage.microsoft.com/)中，選擇 [管理]  &gt; [更新]  。

2. 在 [服務設定: 更新]  頁面的 [產品類別]  清單中，選取要提供給電腦的更新類別。 請注意，預設會選取最常見的更新。

    > [!IMPORTANT]
    > 為了確保電腦能夠收到系統管理員已核准的更新，Windows Server Update Services (WSUS) 群組原則設定 [指定近端內部網路 Microsoft 更新服務的位置]  不得套用到已向 Intune 註冊的電腦。

3. 在 [更新分類]  清單中，選取您要提供給受管理電腦之更新的類別。 同樣地，預設也會選取最常見的項目。

4. 選擇 [儲存]  ，儲存您的選擇。

### <a name="to-configure-automatic-approval-rules-for-software-updates"></a>若要設定軟體更新的自動核准規則

1. 在 [Microsoft Intune 管理主控台](https://manage.microsoft.com/)中，選擇 [管理]  &gt; [更新]  。

2. 在 [Server Settings: Updates]\(伺服器設定: 更新) 頁面的 [自動核准規則] 區段中，選擇 [新增]。

3. 在建立自動核准規則精靈的 [一般]  頁面中，指定規則的名稱和選擇性描述。

4. 在 [產品類別]  頁面上，選取您要自動核准更新的任何產品。

5. 在 [更新類別]  頁面上，指定您要自動核准的更新分類。

6. 在 [部署]  頁面上，執行下列動作：

    - 選取您要部署新規則的電腦群組，然後選擇 [新增]  。

    - 若要指定更新的安裝期限，請選取 [強制實施這些更新的安裝期限]  核取方塊，然後在 [安裝期限]  清單中，選取安裝期限。

        > [!NOTE]
        > 如果您指定安裝期限，在超過期限間隔的情況下，受管理電腦可能需要重新開機一次或多次。

    - 完成之後，請選擇 [下一步]  。

7. 在 [摘要]  頁面上，檢閱新規則的設定，然後選擇 [完成]  。

新規則隨即會顯示在 [服務設定: 更新] 頁面的 [自動核准規則] 區段中。

> [!NOTE]
> 建立自動核准規則後，它只會核准末來的更新，不會自動核准原先就已存在 Intune 中的現有更新。 您必須執行自動核准規則，才能核准這些更新。


### <a name="to-edit-run-or-delete-an-automatically-approved-update-rule"></a>若要編輯、執行或刪除自動核准的更新規則

1. 在 [Microsoft Intune 管理主控台](https://manage.microsoft.com/)中，選擇 [管理]  &gt; [更新]  。

2. 在 [自動核准規則]  區段中，選取規則，然後執行下列其中一項：

    - 若要編輯規則，請選擇 [編輯]  ，然後在 [Update Auto Approval Rule Wizard] \(更新自動核准規則精靈\)  中變更規則的參數。

    - 若要執行規則，請選擇 [執行已選取項目]  。

    - 若要刪除規則，請選擇 [刪除]  。

        > [!NOTE]
        > 刪除規則並不會影響刪除的規則先前已核准的更新。

## <a name="update-software-not-made-by-microsoft"></a>更新非 Microsoft 開發的軟體
您可以部署不是由 Microsoft 開發之軟體的更新。 方法是使用 [上傳更新]  精靈將更新上傳道雲端存放裝置空間，之後您就可以像 Microsoft 軟體一樣核准或拒絕更新。

### <a name="to-upload-and-configure-a-third-party-update"></a>若要上傳和設定協力廠商更新

1. 在 [Microsoft Intune 系統管理主控台](https://manage.microsoft.com/)中，選擇 [更新]  &gt; [概觀]  &gt; [上傳]  。

2. 在 [更新檔案]  頁面上，選擇 [瀏覽]  ，選取安裝更新套件所需的安裝檔。 這個檔案可能是 Windows Installer (.msi) 檔案、Windows Installer 修補程式 (.msp) 檔案，或是 .exe 程式檔案。 您也可以包含與安裝檔相同的資料夾中的任何其他檔案或資料夾。

    畫面上將會顯示所選上傳檔案的大小總計。 請注意，這個大小不包括安裝檔案未壓縮或展開後的大小。

3. 在您指定安裝檔之後，[更新描述]  頁面會顯示 Intune 從軟體安裝檔解壓縮的相關軟體資訊之名稱、描述與分類等。 您可以選取分類來標示您要部署的更新類型 (更新、重大更新、安全性更新、更新彙總套件或 Service Pack 等)。 完成時，請選擇 [下一步] 

4. 在精靈的 [需求]  頁面上，選擇適用於此更新的受管理電腦的架構 (32 位元、64 位元或兩者) 和作業系統。

5. 在 [偵測規則]  頁面上，指定 Intune 如何判斷更新是否已存在受管理電腦上。 如果您使用預設選項 [使用預設偵測規則]  ，Intune 一律會在每部目標電腦上安裝更新封裝一次。

    > [!NOTE]
    > 如果您指定的更新安裝檔是 Windows Installer 或 .msp 檔，精靈的 [偵測規則]  頁面就不會出現。 這是因為 Windows Installer 和 .msp 檔案本身即包含可用來偵測先前更新安裝狀況的指令。

    選取下列一或多個規則，判斷更新是否已安裝在受管理電腦上：

    - **檔案已存在**

    - **MSI 產品代碼已存在**

    - **登錄機碼已存在**

6. 提供設定偵測規則所需的任何進一步資訊 (例如檔案路徑和名稱、Windows Installer 產品代碼或登錄機碼)，然後選擇 [下一步]  。

7. 在精靈的 [必要條件]  頁面上，您可以指定在安裝此更新之前必須先安裝的任何軟體。 您可以指定 [無]  、選取已新增到 Intune 並由其管理的軟體封裝，或指定下列其中一項規則來描述軟體：

    - **檔案已存在**

    - **MSI 產品代碼已存在**

    - **登錄機碼已存在**

8. 提供設定偵測規則所需的任何進一步資訊 (例如檔案路徑和名稱、Windows Installer 產品代碼或登錄機碼)，然後選擇 [下一步]  。

9. 在精靈的 [命令列引數]  頁面中，您可以將任何必要的安裝內容新增到安裝命令列，以修改安裝檔的行為。 例如，部分軟體支援 **/q** 內容來啟用無訊息安裝。 請參閱軟體套件的文件，以瞭解任何支援的命令列引數。 指定您所需的任何命令列引數，然後選擇 [下一步]  。

    > [!NOTE]
    > 如果更新不支援無訊息安裝，您就不能使用 Intune 來安裝更新。

10. 在精靈的 [傳回碼]  頁面上，您可以指定如何解讀更新安裝作業所傳回的傳回碼。 根據預設，Intune 會使用業界標準的傳回碼來回報更新套件安裝失敗或成功。 提供的傳回碼如下：

|傳回碼|詳細資料|
|---------------|------------------|
|**0**|成功|
|**3010**|成功但需要重新啟動|

11. 未列出的任何傳回碼均視為失敗。
某些軟體使用非標準的方式解讀傳回碼。 在這種情況下，您可以指定自己的傳回碼解讀方式。

12. 指定或編輯必要的傳回碼，然後選擇 [下一步]  。

13. 在精靈的 [摘要]  頁面上，檢閱將採取的動作，然後選擇 [上傳]  完成精靈。

上傳的更新會儲存在您購買的 Intune 雲端存放裝置中。 如果可用空間不足而無法上傳更新封裝，您在上傳的過程中會收到通知。 Intune 必須等到更新開始上傳後才能判斷是否有足夠的可用空間，因為壓縮的安裝檔在解壓縮時需要更多的空間。

在上傳到 Intune 後，協力廠商更新會顯示在 [所有更新] 窗格的 [更新] 工作區中。 您接著便可以核准和部署更新。 如需詳細資訊，請參閱＜核准和拒絕更新＞一節。

## <a name="approve-and-decline-updates"></a>核准和拒絕更新
當更新準備好可以安裝時，會在 [更新]  工作區的 [更新概觀]  頁面上的 [更新狀態]  下顯示訊息。 選擇此訊息可開啟 [所有更新]  頁面，以查看哪些更新已準備好取得核准。

您可以使用 [篩選器]  清單，更輕鬆尋找更新。 例如，您可以只顯示失敗的更新，或是被取代的更新。

當您從清單選取更新時，會有進一步的命令可供您用來管理更新，如下表所示：

|工作|詳細資料|
|--------|--------------------|
|**檢視內容**|顯示關於更新的詳細資訊，包括適用的電腦數目。|
|**編輯**|僅適用於非 Microsoft 更新。 可讓您編輯更新的內容。|
|**核准**|核准選取的更新並讓您設定部署該更新的目標群組。 如需詳細資訊，請參閱本主題中的**核准更新**程序。|
|**拒絕**|移除更新的任何先前核准，並從預設檢視隱藏更新。 此外，更新的任何報表資料也會移除。<br /><br />如果您稍後想要尋找拒絕的更新，請將 [所有更新]  頁面上的篩選器設定為 [已拒絕]  。 您接著可以視需要核准此更新。<br /><br />如果是因為更新在 Microsoft Update 中過期而拒絕更新，就無法在 Intune 管理主控台中核准該更新。<br /><br />如果刪除部署到電腦的更新原則，這些更新原則設定的值將會重設為電腦上安裝之作業系統的預設狀態。|
|**刪除**|僅適用於非 Microsoft 更新。 刪除選取的更新。|
|**上傳**|啟動 [上傳更新精靈]  ，可讓您上傳想要部署的非 Microsoft 更新。|

### <a name="to-approve-updates"></a>若要核准更新

1. 在 [Microsoft Intune 系統管理主控台](https://manage.microsoft.com/)中，選擇 [更新]  &gt; [概觀]  &gt; [要核准的新增更新]  。

    在 [更新]  工作區中，選擇 [概觀]  &gt; [要核准的新增更新]  。

    > [!NOTE]
    > 只有當至少有一部受管理電腦需要核准更新時，[要核准的新增更新]  連結才會出現在 [更新狀態]  區域中

2. 選取更新，並檢閱頁面底部的更新內容以確認您要核准該更新，然後選擇 [核准]  。 您可以在選取每個項目的同時按住 **CTRL** 鍵來選取多個更新。

3. 在 [選取群組]  頁面上，選取您要部署更新的目標群組，然後選擇 [新增]  。 完成指定群組之後，選擇 [下一步]  。

4. 在 [部署動作]  頁面上，針對清單中的每個群組執行下列動作：

    - 在 [核准]  清單中，選取下列其中一項：

        - **必要安裝** - 在指定群組中的電腦上安裝更新。

        - **不要安裝** - 僅回報適用性，不會安裝更新。

        - [可用安裝]  – 使用者可以視需要從公司入口網站安裝應用程式。

        - **解除安裝** - 從目標群組中的電腦移除更新。

            > [!IMPORTANT]
            > 即使 Intune 未安裝更新，也會移除更新。

    - 在 [期限]  清單中，選取下列其中一項：

        - **無** - 表示更新未有安裝期限，使用者可以繼續拒絕更新。

        - **盡快** - 下次有機會時在目標電腦上安裝更新。

        - **自訂** - 指定安裝已核准更新的日期和時間。

        - **一週**、 **兩週**或 **一個月** – 在指定的時間期限內安裝更新。

5. 選擇 [完成]  儲存設定，或 [取消]  放棄設定並回到更新清單。

    > [!IMPORTANT]
    > 除非子群組已明確設定 [不要安裝]  、[必要安裝]  或 [解除安裝]  動作，否則所有子群組都會繼承其父群組所設定的動作。

6. 您可以檢查 [所有更新]  頁面底部的詳細資料窗格，查看關於更新的提醒訊息。


## <a name="see-also"></a>請參閱
[保護 Windows 電腦的原則](policies-to-protect-windows-pcs-in-microsoft-intune.md)
